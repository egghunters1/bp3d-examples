/**
    * @bp3d/plugins v0.1.0 build Sat Mar 08 2025
    * undefined
    * Copyright 2025 
    * @license 
    */
import{THREE as e,THREEAddons as t,Plugin as n,VERSION as i,CommonUtils as o,CoordinateSpace as r,TransformMode as s,TextTexture as a,InputManager as c}from"@bp3d/core";function l(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}l("#axisGizmo{background:#ffffff00;bottom:1px;display:block;height:100px;left:10px;position:absolute;width:100px}");class d extends e.Object3D{name="COORDINATE_AXES";AXIS_LENGTH=1;AXIS_COLOR_X=16711680;AXIS_COLOR_Y=65280;AXIS_COLOR_Z=255;constructor(t=!0,n=!1){super();const i=new e.Vector3(0,0,0),o=new e.Vector3(1,0,0),r=new e.Vector3(0,1,0),s=new e.ArrowHelper(o,i,this.AXIS_LENGTH,this.AXIS_COLOR_X,0,0),a=new e.ArrowHelper(r,i,this.AXIS_LENGTH,this.AXIS_COLOR_Y,0,0);if(this.add(s,a),!n){const t=new e.Vector3(0,0,1),n=new e.ArrowHelper(t,i,this.AXIS_LENGTH,this.AXIS_COLOR_Z,0,0);this.add(n)}t&&this.addTexts(n)}addTexts(e=!1){const t=this.createText("X","#ff0000"),n=this.createText("Y","#00ff00");if(t.position.set(this.AXIS_LENGTH+.1,0,0),n.position.set(.1,this.AXIS_LENGTH,.1),this.add(t,n),!e){const e=this.createText("Z","#0000ff");e.position.set(0,0,this.AXIS_LENGTH+.1),this.add(e)}}createText(e,n,i=14){const o=document.createElement("div");o.innerHTML=e;const r=o.style;return r.color=n,r.width=`${i}px`,r.height=`${i}px`,r.textAlign="center",r.top="0px",r.left="0px",new t.CSS2DObject(o)}}class h extends n{static DEFAULT_ID="AxisGizmoPlugin";cfg;enabled=!0;hostCamera;container;coordinateAxes;ignoreZAxis=!1;localCamera;localScene;renderer;css2dRenderer;constructor(e,t){const n=t?.id||h.DEFAULT_ID;super(e,{id:n}),this.cfg=t||{id:n},this.ignoreZAxis=!!t?.ignoreZAxis,this.hostCamera=e.getCamera(),this.init()}setupConfig(e){this.config=e}init(){this.initRenderer(),this.initScene(),this.animate();this.viewer.getCameraManager().cameraMovedCallbacks.add((()=>{this.hostCamera=this.viewer.camera}))}initRenderer(){let n,i=100,o=100;if(this.cfg.containerId&&(n=document.getElementById(this.cfg.containerId),n&&(i=n.clientWidth,o=n.clientHeight)),!n){const e="axisGizmo";n=document.createElement("div"),n.id=e;let t=this.viewer.widgetContainer;t||(t=this.viewer.rootElement),t||(t=document.createElement("div"),t.id="widget-container",document.body.appendChild(t)),t.appendChild(n)}this.renderer=new e.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(i,o),n.appendChild(this.renderer.domElement),this.css2dRenderer=new t.CSS2DRenderer,this.css2dRenderer.setSize(i,o),this.css2dRenderer.domElement.style.height="0",this.css2dRenderer.domElement.style.width="0",n.appendChild(this.css2dRenderer.domElement)}initScene(){this.localScene=new e.Scene,this.localCamera=new e.OrthographicCamera(-1,1,1,-1,.1,100),this.localScene.add(this.localCamera),this.coordinateAxes=new d(!0,this.ignoreZAxis),this.localScene.add(this.coordinateAxes)}render(){this.localScene&&this.localCamera&&(this.renderer&&(this.update(),this.renderer.render(this.localScene,this.localCamera)),this.css2dRenderer?.render(this.localScene,this.localCamera))}animate(){requestAnimationFrame(this.animate.bind(this)),this.render()}update(){if(!this.hostCamera)return;const t=this.hostCamera;if(t){const n=new e.Vector3;t.getWorldDirection(n);const i=t.up;this.updateCameraDirection(n,i)}}updateCameraDirection(e,t){if(!this.localCamera||!e)return;e.normalize();const n=.3;this.localCamera.position.set(2*-e.x+n,2*-e.y+n,2*-e.z+n),this.localCamera.lookAt(n,n,n),this.localCamera.up=t}destroy(){super.destroy(),this.localScene&&this.localCamera&&this.coordinateAxes&&(this.localScene.clear(),this.localScene=void 0,this.css2dRenderer&&(this.container?.removeChild(this.css2dRenderer.domElement),this.css2dRenderer=void 0),this.renderer&&(this.container?.removeChild(this.renderer.domElement),this.renderer.dispose(),this.renderer.forceContextLoss(),this.renderer=void 0),this.hostCamera=void 0,this.localCamera=void 0,this.coordinateAxes=void 0)}}l(".bottom-bar{bottom:0;color:#666;display:flex;overflow:hidden;position:absolute;right:0;user-select:none;z-index:3;i{align-self:center;cursor:pointer;font-size:18px;margin-right:2px;opacity:.4;&.active,&:hover{color:#2c7be5;opacity:1}}.fps{width:4rem}span{align-self:center;font-size:14px;padding:4px}}#bp3d-cameraCfg-tooltip,#bp3d-statistics-tooltip,#bp3d-tips-tooltip{background:#666;border-radius:4px;bottom:30px;color:#fff;font-size:.8rem;opacity:.9;padding:8px 8px 5px;position:absolute;right:5px;user-select:none;z-index:3;p{margin:3px;padding-bottom:3px;span{float:left;margin-right:10px}}}");l(".follow-tooltip{background:rgba(25,25,25,.3);border-radius:2px;color:hsla(0,0%,100%,.8);font-size:12px;left:-500px;padding:6px;position:absolute;z-index:99999999}");class u{node;parentNode;target;childNode;constructor(e,t,n){this.node=document.createElement("div"),this.node.id=e,t&&this.node.append(t),this.childNode=document.createElement("div"),this.target=n?.target,this.parentNode=n?.parentNode||document.body,n?.followPointer&&(this.node.classList.add("follow-tooltip"),this.target?this.target.addEventListener("mousemove",this.follow):document.addEventListener("mousemove",this.follow)),this.parentNode.appendChild(this.node),n?.showOnCreate||this.node.setAttribute("hidden","")}setContent(e){this.node.textContent&&(this.node.textContent=null);for(let e=0;e<this.node.children.length;++e){const t=this.node.children[e];this.node.removeChild(t)}this.node.append(e),this.node.appendChild(this.childNode)}updateChildContent(e){this.childNode.textContent&&(this.childNode.textContent=null);for(let e=0;e<this.node.children.length;++e){const t=this.node.children[e];this.node.removeChild(t)}this.childNode.append(e)}follow=e=>{this.node.style.left=e.offsetX+15+"px",this.node.style.top=e.offsetY-30+"px"};show=()=>this.node.hasAttribute("hidden")&&this.node.removeAttribute("hidden");hide=()=>!this.node.hasAttribute("hidden")&&this.node.setAttribute("hidden","");destroy=()=>{this.target?this.target.removeEventListener("mousemove",this.follow):document.removeEventListener("mousemove",this.follow),this.parentNode.removeChild(this.node)}}var p;!function(e){e.statistics="bp3d-statistics",e.cameraCfg="bp3d-cameraCfg",e.tips="bp3d-tips"}(p||(p={}));const g=e=>{const t=document.createElement("span"),n=(e=>{const t=e.renderer.info;return{drawCalls:t.render.calls,lines:t.render.lines,points:t.render.points,triangles:t.render.triangles,geometries:t.memory.geometries,textures:t.memory.textures,materials:t.programs?.length||0}})(e.viewer),o=(e,n)=>{t.innerHTML+=`<p><span>${e}:</span>${n}</p>`};t.innerHTML="<p>-- Renderer Info --</p>";const r=` (${(e=>{const t=e.renderer?.domElement;return t?.dataset.engine})(e.viewer)})`;return o("Version",`@bp3d/core v${i}${r}`),o("DrawCalls",n.drawCalls),o("Points",n.points),o("Lines",n.lines),o("Triangles",n.triangles),o("Materials",n.materials),o("Textures",n.textures),o("Geometries",n.geometries),t},f=e=>{const t=document.createElement("span"),n=e.viewer.getCameraConfig(),i=(e,n)=>{t.innerHTML+=`<p><span>${e}:</span>${n}</p>`};t.innerHTML="";const r=e=>o.numberToString(e),s=e=>o.vectorToString(e);return i("Camera type",e.viewer.getCameraProjection()),i("Camera position",s(n.eye)),i("Camera target",s(n.look)),i("Camera up",s(n.up)),i("Camera near",r(n.near||0)),i("Camera far",r(n.far||0)),t},m={[p.statistics]:{icon:'\n    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n        <path d="M2,10 A 8 8 0 0 1 18 10 M2,10 A 8 8 0 0 0 18 10 M10,8 v7 M9.7,6 A0.3 0.3 0 0 1 10.3,6 M9.7,6 A0.3 0.3 0 0 0 10.3,6" fill="none" stroke="#333C4E" stroke-width="1"/>\n    </svg>',mutexIds:[p.cameraCfg,p.tips],onActive:e=>{const t=g(e);e.tooltip.setContent(t),e.tooltip.show()},onDeactive:e=>{e.tooltip.hide()},onUpdate:e=>{const t=g(e);e.tooltip.setContent(t)}},[p.cameraCfg]:{icon:'\n    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n        <path d="M2,10 A 8 8.3 90 0 1 18 10 M2,10 A 8 9 90 0 0 18 10" fill="none" stroke="#333C4E" stroke-width="1"/>\n        <path d="M6,10 A 4 4.3 90 0 1 14 10 M6,10 A 4 4.5 90 0 0 14 10" fill="none" stroke="#333C4E" stroke-width="1"/>\n    </svg>',mutexIds:[p.statistics,p.tips],onActive:e=>{const t=f(e);e.tooltip.setContent(t),e.tooltip.show()},onDeactive:e=>{e.tooltip.hide()},onUpdate:e=>{const t=f(e);e.tooltip.setContent(t)}},[p.tips]:{icon:'\n    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n        <path d="M3,10 A1 1 0 0 1 5,10 M3,10 A1 1 0 0 0 5,10 M9,10 A1 1 0 0 1 11,10 M9,10 A1 1 0 0 0 11,10 M15,10 A1 1 0 0 1 17,10 M15,10 A1 1 0 0 0 17,10" fill="none" stroke="#333C4E" stroke-width="1"/>\n    </svg>',mutexIds:[p.cameraCfg,p.cameraCfg],onActive:e=>{const t=document.createElement("span");t.innerHTML="\n                <p><span>W: </span>Move forward</p>\n                <p><span>A: </span>Move backward</p>\n                <p><span>S: </span>Move left</p>\n                <p><span>D: </span>Move right</p>\n                <p><span>Q: </span>Rise up</p>\n                <p><span>E: </span>Lower down</p>\n                <p><span>↑: </span>Rotate up</p>\n                <p><span>↓: </span>Rotate down</p>\n                <p><span>←: </span>Rotate to left</p>\n                <p><span>→: </span>Rotate to right</p>\n                <p><span>R: </span>Translate / Rotate / Scale</p>\n                ",e.tooltip.setContent(t),e.tooltip.show()},onDeactive:e=>{e.tooltip.hide()}}};class v extends n{static DEFAULT_ID="BottomBarPlugin";enabled=!0;element;itemList=new Map;constructor(e){super(e,{id:v.DEFAULT_ID}),this.init()}setupConfig(e){this.config=e}update(){this.itemList.forEach((e=>{e.update()}))}init(){const e=document.createElement("div");e.id="bottomBar",e.classList.add("bottom-bar");for(const t in m){const n=m[t],i=this.createItem(this.viewer,t,n);e.appendChild(i.element)}this.element=e,this.viewer.rootElement?.appendChild(this.element);this.viewer.getCameraManager().cameraMovedCallbacks.add((()=>{this.update()}))}createItem(e,t,n){const i=new w(e,this,t,n);return this.itemList.set(t,i),i}}class w{viewer;bottomBar;menuId;cfg;eventBus=function(e){return{all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}}}();itemconfig;tooltip;element;active=!1;constructor(e,t,n,i){this.viewer=e,this.bottomBar=t,this.menuId=n,this.cfg=i,this.itemconfig=i,this.element=this.createButton(this.menuId,i),this.tooltip=new u(n+"-tooltip",null,{parentNode:e.rootElement}),this.eventBus.on("activitychange",(e=>{e?(this.element.classList.add("active"),i.mutexIds?.forEach((e=>{const t=this.bottomBar?.itemList.get(e);t&&t.active&&t.setActive(!1)})),i.onActive&&i.onActive(this)):(this.element.classList.remove("active"),i.onDeactive&&i.onDeactive(this))}))}createButton(e,t){const n=document.createElement("i");return n.id=e,n.innerHTML=t.icon,n.onclick=()=>{this.active=!this.active,t.onClick&&t.onClick(this),this.eventBus.emit("activitychange",this.active)},n}setActive(e){this.active=e,this.eventBus.emit("activitychange",this.active)}update(){this.active&&this.itemconfig.onUpdate&&this.itemconfig.onUpdate(this)}}class b extends n{static DEFAULT_ID="GroundGridPlugin";enabled=!0;NAME="GROUND_GRID";DEFAULT_SIZE=1e3;DEFAULT_DIVISIONS=1e3;DEFAULT_MAT_PARAMS={color:12829635,transparent:!0,opacity:.5,wireframeLinewidth:.5};cfg;gridHelper;constructor(e,t){const n=t?.id||b.DEFAULT_ID;super(e,{id:n}),this.cfg=t||{id:n},!1!==this.cfg.visible&&this.init()}setupConfig(e){this.config=e}init(){this.gridHelper&&(this.viewer.scene?.remove(this.gridHelper),this.gridHelper=void 0);const t=this.cfg.size,n=this.cfg.divisions,i=new e.Vector3,o=this.viewer.getBBox();o&&o.getCenter(i),this.gridHelper=this.createGroundGrid(t,n,i),this.viewer.addObjectToScene(this.gridHelper),this.viewer.setNeedsUpdate()}setVisible(e){e&&!this.gridHelper&&this.init(),this.gridHelper&&(this.gridHelper.visible=e),this.viewer.setNeedsUpdate()}isVisible(){return!!this.gridHelper?.visible}onModelLoaded=()=>{!1!==this.cfg.visible&&(this.init(),this.viewer.setNeedsUpdate())};createGroundGrid(t,n,i){t=t||this.DEFAULT_SIZE,n=n||this.DEFAULT_DIVISIONS;const o=new e.GridHelper(t,n);i?o.position.set(i.x,i.y,i.z):o.position.y=0;const r=o.material;return Array.isArray(r)||(r.opacity=this.DEFAULT_MAT_PARAMS.opacity,r.transparent=this.DEFAULT_MAT_PARAMS.transparent),o.name=this.NAME,o.layers.enableAll(),o.matrixAutoUpdate=!1,o.updateMatrix(),o}destroy(){super.destroy(),this.gridHelper&&(this.gridHelper.removeFromParent(),this.gridHelper.geometry.dispose(),this.gridHelper.clear(),this.gridHelper=void 0)}}l("#planToolbar{display:block;left:20px;position:absolute;top:20px}.plan-toolbar-btn{margin-right:3px}");function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=y(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,k(i.key),i)}}function E(e,t,n){return t&&C(e.prototype,t),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}function R(e,t){if(t&&("object"==y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function B(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function T(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},N=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x(this,e),this.init(t,n)}return E(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||I,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,i){return i&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,A(A({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}},{key:"clone",value:function(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new e(this.logger,t)}}]),e}()),V=function(){function e(){x(this,e),this.observers={}}return E(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.observers[e]&&[].concat(this.observers[e]).forEach((function(e){e.apply(void 0,n)}));this.observers["*"]&&[].concat(this.observers["*"]).forEach((function(t){t.apply(t,[e].concat(n))}))}}]),e}();function j(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function F(e){return null==e?"":""+e}function H(e,t,n){function i(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function o(){return!e||"string"==typeof e}for(var r="string"!=typeof t?[].concat(t):t.split(".");r.length>1;){if(o())return{};var s=i(r.shift());!e[s]&&n&&(e[s]=new n),e=Object.prototype.hasOwnProperty.call(e,s)?e[s]:{}}return o()?{}:{obj:e,k:i(r.shift())}}function _(e,t,n){var i=H(e,t,Object);i.obj[i.k]=n}function U(e,t){var n=H(e,t),i=n.obj,o=n.k;if(i)return i[o]}function z(e,t,n){var i=U(e,n);return void 0!==i?i:U(t,n)}function G(e,t,n){for(var i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?"string"==typeof e[i]||e[i]instanceof String||"string"==typeof t[i]||t[i]instanceof String?n&&(e[i]=t[i]):G(e[i],t[i],n):e[i]=t[i]);return e}function W(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function X(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return K[e]})):e}var Y="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,$=[" ",",","?","!",";"];function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=D(e);if(t){var o=D(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return R(this,n)}}function Q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var i=t.split(n),o=e,r=0;r<i.length;++r){if(!o)return;if("string"==typeof o[i[r]]&&r+1<i.length)return;if(void 0===o[i[r]]){for(var s=2,a=i.slice(r,r+s).join(n),c=o[a];void 0===c&&i.length>r+s;)s++,c=o[a=i.slice(r,r+s).join(n)];if(void 0===c)return;if(null===c)return null;if(t.endsWith(a)){if("string"==typeof c)return c;if(a&&"string"==typeof c[a])return c[a]}var l=i.slice(r+s).join(n);return l?Q(c,l,n):void 0}o=o[i[r]]}return o}}var ee=function(){O(t,V);var e=J(t);function t(n){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return x(this,t),i=e.call(this),Y&&V.call(S(i)),i.data=n||{},i.options=o,void 0===i.options.keySeparator&&(i.options.keySeparator="."),void 0===i.options.ignoreJSONStructure&&(i.options.ignoreJSONStructure=!0),i}return E(t,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,r=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure,s=[e,t];n&&"string"!=typeof n&&(s=s.concat(n)),n&&"string"==typeof n&&(s=s.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(s=e.split("."));var a=U(this.data,s);return a||!r||"string"!=typeof n?a:Q(this.data&&this.data[e]&&this.data[e][t],n,o)}},{key:"addResource",value:function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},r=this.options.keySeparator;void 0===r&&(r=".");var s=[e,t];n&&(s=s.concat(r?n.split(r):n)),e.indexOf(".")>-1&&(i=t,t=(s=e.split("."))[1]),this.addNamespaces(t),_(this.data,s,i),o.silent||this.emit("added",e,t,n,i)}},{key:"addResources",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var o in n)"string"!=typeof n[o]&&"[object Array]"!==Object.prototype.toString.apply(n[o])||this.addResource(e,t,o,n[o],{silent:!0});i.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[e,t];e.indexOf(".")>-1&&(i=n,n=t,t=(s=e.split("."))[1]),this.addNamespaces(t);var a=U(this.data,s)||{};i?G(a,n,o):a=q(q({},a),n),_(this.data,s,a),r.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?q(q({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),t}(),te={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,i,o){var r=this;return e.forEach((function(e){r.processors[e]&&(t=r.processors[e].process(t,n,i,o))})),t}};function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=D(e);if(t){var o=D(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return R(this,n)}}var re={},se=function(){O(t,V);var e=oe(t);function t(n){var i,o,r,s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return x(this,t),i=e.call(this),Y&&V.call(S(i)),o=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],r=n,s=S(i),o.forEach((function(e){r[e]&&(s[e]=r[e])})),i.options=a,void 0===i.options.keySeparator&&(i.options.keySeparator="."),i.logger=N.create("translator"),i}return E(t,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,o=t.ns||this.options.defaultNS||[],r=n&&e.indexOf(n)>-1,s=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,n){t=t||"",n=n||"";var i=$.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===i.length)return!0;var o=new RegExp("(".concat(i.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),r=!o.test(e);if(!r){var s=e.indexOf(n);s>0&&!o.test(e.substring(0,s))&&(r=!0)}return r}(e,n,i));if(r&&!s){var a=e.match(this.interpolator.nestingRegexp);if(a&&a.length>0)return{key:e,namespaces:o};var c=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(c[0])>-1)&&(o=c.shift()),e=c.join(i)}return"string"==typeof o&&(o=[o]),{key:e,namespaces:o}}},{key:"translate",value:function(e,n,i){var o=this;if("object"!==y(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n||(n={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var r=void 0!==n.returnDetails?n.returnDetails:this.options.returnDetails,s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,a=this.extractFromKey(e[e.length-1],n),c=a.key,l=a.namespaces,d=l[l.length-1],h=n.lng||this.language,u=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(h&&"cimode"===h.toLowerCase()){if(u){var p=n.nsSeparator||this.options.nsSeparator;return r?(g.res="".concat(d).concat(p).concat(c),g):"".concat(d).concat(p).concat(c)}return r?(g.res=c,g):c}var g=this.resolve(e,n),f=g&&g.res,m=g&&g.usedKey||c,v=g&&g.exactUsedKey||c,w=Object.prototype.toString.apply(f),b=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,x=!this.i18nFormat||this.i18nFormat.handleAsObject;if(x&&f&&("string"!=typeof f&&"boolean"!=typeof f&&"number"!=typeof f)&&["[object Number]","[object Function]","[object RegExp]"].indexOf(w)<0&&("string"!=typeof b||"[object Array]"!==w)){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var k=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,f,ie(ie({},n),{},{ns:l})):"key '".concat(c," (").concat(this.language,")' returned an object instead of string.");return r?(g.res=k,g):k}if(s){var C="[object Array]"===w,E=C?[]:{},S=C?v:m;for(var L in f)if(Object.prototype.hasOwnProperty.call(f,L)){var O="".concat(S).concat(s).concat(L);E[L]=this.translate(O,ie(ie({},n),{joinArrays:!1,ns:l})),E[L]===O&&(E[L]=f[L])}f=E}}else if(x&&"string"==typeof b&&"[object Array]"===w)(f=f.join(b))&&(f=this.extendTranslation(f,e,n,i));else{var R=!1,D=!1,B=void 0!==n.count&&"string"!=typeof n.count,P=t.hasDefaultValue(n),T=B?this.pluralResolver.getSuffix(h,n.count,n):"",M=n["defaultValue".concat(T)]||n.defaultValue;!this.isValidLookup(f)&&P&&(R=!0,f=M),this.isValidLookup(f)||(D=!0,f=c);var A=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&D?void 0:f,I=P&&M!==f&&this.options.updateMissing;if(D||R||I){if(this.logger.log(I?"updateKey":"missingKey",h,d,c,I?M:f),s){var N=this.resolve(c,ie(ie({},n),{},{keySeparator:!1}));N&&N.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var V=[],j=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&j&&j[0])for(var F=0;F<j.length;F++)V.push(j[F]);else"all"===this.options.saveMissingTo?V=this.languageUtils.toResolveHierarchy(n.lng||this.language):V.push(n.lng||this.language);var H=function(e,t,i){var r=P&&i!==f?i:A;o.options.missingKeyHandler?o.options.missingKeyHandler(e,d,t,r,I,n):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(e,d,t,r,I,n),o.emit("missingKey",e,d,t,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&B?V.forEach((function(e){o.pluralResolver.getSuffixes(e,n).forEach((function(t){H([e],c+t,n["defaultValue".concat(t)]||M)}))})):H(V,c,M))}f=this.extendTranslation(f,e,n,g,i),D&&f===c&&this.options.appendNamespaceToMissingKey&&(f="".concat(d,":").concat(c)),(D||R)&&this.options.parseMissingKeyHandler&&(f="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(d,":").concat(c):c,R?f:void 0):this.options.parseMissingKeyHandler(f))}return r?(g.res=f,g):f}},{key:"extendTranslation",value:function(e,t,n,i,o){var r=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,ie(ie({},this.options.interpolation.defaultVariables),n),i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(ie(ie({},n),{interpolation:ie(ie({},this.options.interpolation),n.interpolation)}));var s,a="string"==typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(a){var c=e.match(this.interpolator.nestingRegexp);s=c&&c.length}var l=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(l=ie(ie({},this.options.interpolation.defaultVariables),l)),e=this.interpolator.interpolate(e,l,n.lng||this.language,n),a){var d=e.match(this.interpolator.nestingRegexp);s<(d&&d.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return o&&o[0]===i[0]&&!n.context?(r.logger.warn("It seems you are nesting recursively key: ".concat(i[0]," in key: ").concat(t[0])),null):r.translate.apply(r,i.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var h=n.postProcess||this.options.postProcess,u="string"==typeof h?[h]:h;return null!=e&&u&&u.length&&!1!==n.applyPostProcessor&&(e=te.handle(u,e,t,this.options&&this.options.postProcessPassResolved?ie({i18nResolved:i},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,i,o,r,s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!s.isValidLookup(t)){var c=s.extractFromKey(e,a),l=c.key;n=l;var d=c.namespaces;s.options.fallbackNS&&(d=d.concat(s.options.fallbackNS));var h=void 0!==a.count&&"string"!=typeof a.count,u=h&&!a.ordinal&&0===a.count&&s.pluralResolver.shouldUseIntlApi(),p=void 0!==a.context&&("string"==typeof a.context||"number"==typeof a.context)&&""!==a.context,g=a.lngs?a.lngs:s.languageUtils.toResolveHierarchy(a.lng||s.language,a.fallbackLng);d.forEach((function(e){s.isValidLookup(t)||(r=e,!re["".concat(g[0],"-").concat(e)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(r)&&(re["".concat(g[0],"-").concat(e)]=!0,s.logger.warn('key "'.concat(n,'" for languages "').concat(g.join(", "),'" won\'t get resolved as namespace "').concat(r,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach((function(n){if(!s.isValidLookup(t)){o=n;var r,c=[l];if(s.i18nFormat&&s.i18nFormat.addLookupKeys)s.i18nFormat.addLookupKeys(c,l,n,e,a);else{var d;h&&(d=s.pluralResolver.getSuffix(n,a.count,a));var g="".concat(s.options.pluralSeparator,"zero");if(h&&(c.push(l+d),u&&c.push(l+g)),p){var f="".concat(l).concat(s.options.contextSeparator).concat(a.context);c.push(f),h&&(c.push(f+d),u&&c.push(f+g))}}for(;r=c.pop();)s.isValidLookup(t)||(i=r,t=s.getResource(n,e,r,a))}})))}))}})),{res:t,usedKey:n,exactUsedKey:i,usedLng:o,usedNS:r}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}}],[{key:"hasDefaultValue",value:function(e){var t="defaultValue";for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,12)&&void 0!==e[n])return!0;return!1}}]),t}();function ae(e){return e.charAt(0).toUpperCase()+e.slice(1)}var ce=function(){function e(t){x(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=N.create("languageUtils")}return E(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=ae(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=ae(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=ae(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var i=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(i)||(t=i)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var i=n.getLanguagePartFromCode(e);if(n.isSupportedCode(i))return t=i;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(i))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,i=this.getFallbackCodes(t||this.options.fallbackLng||[],e),o=[],r=function(e){e&&(n.isSupportedCode(e)?o.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&r(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&r(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&r(this.getLanguagePartFromCode(e))):"string"==typeof e&&r(this.formatLanguageCode(e)),i.forEach((function(e){o.indexOf(e)<0&&r(n.formatLanguageCode(e))})),o}}]),e}(),le=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],de={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},he=["v1","v2","v3"],ue={zero:0,one:1,two:2,few:3,many:4,other:5};var pe=function(){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x(this,e),this.languageUtils=t,this.options=i,this.logger=N.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(n={},le.forEach((function(e){e.lngs.forEach((function(t){n[t]={numbers:e.nr,plurals:de[e.fc]}}))})),n)}return E(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(e){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getRule(e,n);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort((function(e,t){return ue[e]-ue[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):i.numbers.map((function(i){return t.getSuffix(e,i,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getRule(e,n);return i?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(i.select(t)):this.getSuffixRetroCompatible(i,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,i=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),o=e.numbers[i];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var r=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):r():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?r():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}},{key:"shouldUseIntlApi",value:function(){return!he.includes(this.options.compatibilityJSON)}}]),e}();function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};x(this,e),this.logger=N.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return E(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:X,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?W(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?W(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?W(t.nestingPrefix):t.nestingPrefixEscaped||W("$t("),this.nestingSuffix=t.nestingSuffix?W(t.nestingSuffix):t.nestingSuffixEscaped||W(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,i){var o,r,s,a=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(e){return e.replace(/\$/g,"$$$$")}var d=function(e){if(e.indexOf(a.formatSeparator)<0){var o=z(t,c,e);return a.alwaysFormat?a.format(o,void 0,n,fe(fe(fe({},i),t),{},{interpolationkey:e})):o}var r=e.split(a.formatSeparator),s=r.shift().trim(),l=r.join(a.formatSeparator).trim();return a.format(z(t,c,s),l,n,fe(fe(fe({},i),t),{},{interpolationkey:s}))};this.resetRegExp();var h=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,u=i&&i.interpolation&&void 0!==i.interpolation.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return l(e)}},{regex:this.regexp,safeValue:function(e){return a.escapeValue?l(a.escape(e)):l(e)}}].forEach((function(t){for(s=0;o=t.regex.exec(e);){var n=o[1].trim();if(void 0===(r=d(n)))if("function"==typeof h){var c=h(e,o,i);r="string"==typeof c?c:""}else if(i&&i.hasOwnProperty(n))r="";else{if(u){r=o[0];continue}a.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),r=""}else"string"==typeof r||a.useRawValueToEscape||(r=F(r));var l=t.safeValue(r);if(e=e.replace(o[0],l),u?(t.regex.lastIndex+=r.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,++s>=a.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,i,o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=fe({},r);function a(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var i=e.split(new RegExp("".concat(n,"[ ]*{"))),o="{".concat(i[1]);e=i[0];var r=(o=this.interpolate(o,s)).match(/'/g),a=o.match(/"/g);(r&&r.length%2==0&&!a||a.length%2!=0)&&(o=o.replace(/'/g,'"'));try{s=JSON.parse(o),t&&(s=fe(fe({},t),s))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(o)}return delete s.defaultValue,e}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(e);){var c=[],l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var d=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=d.shift(),c=d,l=!0}if((i=t(a.call(this,n[1].trim(),s),s))&&n[0]===e&&"string"!=typeof i)return i;"string"!=typeof i&&(i=F(i)),i||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),i=""),l&&(i=c.reduce((function(e,t){return o.format(e,t,r.lng,fe(fe({},r),{},{interpolationkey:n[1].trim()}))}),i.trim())),e=e.replace(n[0],i),this.regexp.lastIndex=0}return e}}]),e}();function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e){var t={};return function(n,i,o){var r=i+JSON.stringify(o),s=t[r];return s||(s=e(i,o),t[r]=s),s(n)}}var ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};x(this,e),this.logger=N.create("formatter"),this.options=t,this.formats={number:be((function(e,t){var n=new Intl.NumberFormat(e,t);return function(e){return n.format(e)}})),currency:be((function(e,t){var n=new Intl.NumberFormat(e,we(we({},t),{},{style:"currency"}));return function(e){return n.format(e)}})),datetime:be((function(e,t){var n=new Intl.DateTimeFormat(e,we({},t));return function(e){return n.format(e)}})),relativetime:be((function(e,t){var n=new Intl.RelativeTimeFormat(e,we({},t));return function(e){return n.format(e,t.range||"day")}})),list:be((function(e,t){var n=new Intl.ListFormat(e,we({},t));return function(e){return n.format(e)}}))},this.init(t)}return E(e,[{key:"init",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"addCached",value:function(e,t){this.formats[e.toLowerCase().trim()]=be(t)}},{key:"format",value:function(e,t,n,i){var o=this;return t.split(this.formatSeparator).reduce((function(e,t){var r=function(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var i=e.split("(");t=i[0].toLowerCase().trim();var o=i[1].substring(0,i[1].length-1);"currency"===t&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach((function(e){if(e){var t=T(e.split(":")),i=t[0],o=t.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[i.trim()]||(n[i.trim()]=o),"false"===o&&(n[i.trim()]=!1),"true"===o&&(n[i.trim()]=!0),isNaN(o)||(n[i.trim()]=parseInt(o,10))}}))}return{formatName:t,formatOptions:n}}(t),s=r.formatName,a=r.formatOptions;if(o.formats[s]){var c=e;try{var l=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},d=l.locale||l.lng||i.locale||i.lng||n;c=o.formats[s](e,d,we(we(we({},a),i),l))}catch(e){o.logger.warn(e)}return c}return o.logger.warn("there was no format function for ".concat(s)),e}),e)}}]),e}();function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=D(e);if(t){var o=D(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return R(this,n)}}var Ee=function(){O(t,V);var e=Ce(t);function t(n,i,o){var r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return x(this,t),r=e.call(this),Y&&V.call(S(r)),r.backend=n,r.store=i,r.services=o,r.languageUtils=o.languageUtils,r.options=s,r.logger=N.create("backendConnector"),r.waitingReads=[],r.maxParallelReads=s.maxParallelReads||10,r.readingCalls=0,r.maxRetries=s.maxRetries>=0?s.maxRetries:5,r.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,r.state={},r.queue=[],r.backend&&r.backend.init&&r.backend.init(o,s.backend,s),r}return E(t,[{key:"queueLoad",value:function(e,t,n,i){var o=this,r={},s={},a={},c={};return e.forEach((function(e){var i=!0;t.forEach((function(t){var a="".concat(e,"|").concat(t);!n.reload&&o.store.hasResourceBundle(e,t)?o.state[a]=2:o.state[a]<0||(1===o.state[a]?void 0===s[a]&&(s[a]=!0):(o.state[a]=1,i=!1,void 0===s[a]&&(s[a]=!0),void 0===r[a]&&(r[a]=!0),void 0===c[t]&&(c[t]=!0)))})),i||(a[e]=!0)})),(Object.keys(r).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(r),pending:Object.keys(s),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(c)}}},{key:"loaded",value:function(e,t,n){var i=e.split("|"),o=i[0],r=i[1];t&&this.emit("failedLoading",o,r,t),n&&this.store.addResourceBundle(o,r,n),this.state[e]=t?-1:2;var s={};this.queue.forEach((function(n){var i,a,c,l,d;i=n.loaded,a=r,c=H(i,[o],Object),l=c.obj,d=c.k,l[d]=l[d]||[],l[d].push(a),function(e,t){void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)}(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(e){s[e]||(s[e]={});var t=n.loaded[e];t.length&&t.forEach((function(t){void 0===s[e][t]&&(s[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",s),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;return e.length?this.readingCalls>=this.maxParallelReads?void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:o,wait:r,callback:s}):(this.readingCalls++,this.backend[n](e,t,(function(a,c){if(i.readingCalls--,i.waitingReads.length>0){var l=i.waitingReads.shift();i.read(l.lng,l.ns,l.fcName,l.tried,l.wait,l.callback)}a&&c&&o<i.maxRetries?setTimeout((function(){i.read.call(i,e,t,n,o+1,2*r,s)}),r):s(a,c)}))):s(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var r=this.queueLoad(e,t,i,o);if(!r.toLoad.length)return r.pending.length||o(),null;r.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e.split("|"),o=i[0],r=i[1];this.read(o,r,"read",void 0,void 0,(function(i,s){i&&t.logger.warn("".concat(n,"loading namespace ").concat(r," for language ").concat(o," failed"),i),!i&&s&&t.logger.log("".concat(n,"loaded namespace ").concat(r," for language ").concat(o),s),t.loaded(e,i,s)}))}},{key:"saveMissing",value:function(e,t,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,i,null,ke(ke({},r),{},{isUpdate:o})),e&&e[0]&&this.store.addResource(e[0],t,n,i))}}]),t}();function Se(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=D(e);if(t){var o=D(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return R(this,n)}}function De(){}var Be=function(){O(t,V);var e=Re(t);function t(){var n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(x(this,t),n=e.call(this),Y&&V.call(S(n)),n.options=Se(o),n.services={},n.logger=N,n.modules={external:[]},i=S(n),Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach((function(e){"function"==typeof i[e]&&(i[e]=i[e].bind(i))})),r&&!n.isInitialized&&!o.isClone){if(!n.options.initImmediate)return n.init(o,r),R(n,S(n));setTimeout((function(){n.init(o,r)}),0)}return n}return E(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var i={debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===y(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===y(e[2])||"object"===y(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,i){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}};function o(e){return e?"function"==typeof e?new e:e:null}if(this.options=Oe(Oe(Oe({},i),this.options),Se(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=Oe(Oe({},i.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var r;this.modules.logger?N.init(o(this.modules.logger),this.options):N.init(null,this.options),this.modules.formatter?r=this.modules.formatter:"undefined"!=typeof Intl&&(r=ye);var s=new ce(this.options);this.store=new ee(this.options.resources,this.options);var a=this.services;a.logger=N,a.resourceStore=this.store,a.languageUtils=s,a.pluralResolver=new pe(s,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!r||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(a.formatter=o(r),a.formatter.init(a,this.options),this.options.interpolation.format=a.formatter.format.bind(a.formatter)),a.interpolator=new me(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new Ee(o(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];e.emit.apply(e,[t].concat(i))})),this.modules.languageDetector&&(a.languageDetector=o(this.modules.languageDetector),a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=o(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new se(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];e.emit.apply(e,[t].concat(i))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=De),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&"dev"!==c[0]&&(this.options.lng=c[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var l=j(),d=function(){var t=function(t,i){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),l.resolve(i),n(t,i)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?d():setTimeout(d,0),l}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:De,i="string"==typeof e?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(i&&"cimode"===i.toLowerCase())return n();var o=[],r=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){o.indexOf(e)<0&&o.push(e)}))};if(i)r(i);else this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((function(e){return r(e)}));this.options.preload&&this.options.preload.forEach((function(e){return r(e)})),this.services.backendConnector.load(o,this.options.ns,(function(e){e||t.resolvedLanguage||!t.language||t.setResolvedLanguage(t.language),n(e)}))}else n(null)}},{key:"reloadResources",value:function(e,t,n){var i=j();return e||(e=this.languages),t||(t=this.options.ns),n||(n=De),this.services.backendConnector.reload(e,t,(function(e){i.resolve(),n(e)})),i}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&te.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"setResolvedLanguage",value:function(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<this.languages.length;t++){var n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var i=j();this.emit("languageChanging",e);var o=function(e){n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,n.setResolvedLanguage(e)},r=function(r){e||r||!n.services.languageDetector||(r=[]);var s="string"==typeof r?r:n.services.languageUtils.getBestMatchFromCodes(r);s&&(n.language||o(s),n.translator.language||n.translator.changeLanguage(s),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(s)),n.loadResources(s,(function(e){!function(e,r){r?(o(r),n.translator.changeLanguage(r),n.isLanguageChangingTo=void 0,n.emit("languageChanged",r),n.logger.log("languageChanged",r)):n.isLanguageChangingTo=void 0,i.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,s)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(r):r(e):r(this.services.languageDetector.detect()),i}},{key:"getFixedT",value:function(e,t,n){var i=this,o=function e(t,o){var r;if("object"!==y(o)){for(var s=arguments.length,a=new Array(s>2?s-2:0),c=2;c<s;c++)a[c-2]=arguments[c];r=i.options.overloadTranslationOptionHandler([t,o].concat(a))}else r=Oe({},o);r.lng=r.lng||e.lng,r.lngs=r.lngs||e.lngs,r.ns=r.ns||e.ns,r.keyPrefix=r.keyPrefix||n||e.keyPrefix;var l=i.options.keySeparator||".",d=r.keyPrefix?"".concat(r.keyPrefix).concat(l).concat(t):t;return i.t(d,r)};return"string"==typeof e?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=n,o}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var i=this.resolvedLanguage||this.languages[0],o=!!this.options&&this.options.fallbackLng,r=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;var s=function(e,n){var i=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===i||2===i};if(n.precheck){var a=n.precheck(this,s);if(void 0!==a)return a}return!!this.hasResourceBundle(i,e)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!s(i,e)||o&&!s(r,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,i=j();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){i.resolve(),t&&t(e)})),i):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=j();"string"==typeof e&&(e=[e]);var i=this.options.preload||[],o=e.filter((function(e){return i.indexOf(e)<0}));return o.length?(this.options.preload=i.concat(o),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:De,o=Oe(Oe(Oe({},this.options),n),{isClone:!0}),r=new t(o);void 0===n.debug&&void 0===n.prefix||(r.logger=r.logger.clone(n));return["store","services","language"].forEach((function(t){r[t]=e[t]})),r.services=Oe({},this.services),r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r.translator=new se(r.services,r.options),r.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];r.emit.apply(r,[e].concat(n))})),r.init(o,i),r.translator.options=r.options,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),t}();B(Be,"createInstance",(function(){return new Be(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}));var Pe=Be.createInstance();Pe.createInstance=Be.createInstance,Pe.createInstance,Pe.init,Pe.loadResources,Pe.reloadResources,Pe.use,Pe.changeLanguage,Pe.getFixedT,Pe.t,Pe.exists,Pe.setDefaultNamespace,Pe.hasLoadedNamespace,Pe.loadNamespaces,Pe.loadLanguages;const Te=Pe.createInstance();Te.init({lng:"en",debug:!1,resources:{en:{translation:{newPlan:"New Plan",savePlan:"Save Plan",loadPlan:"Load Plan",exportToGltf:"Export to glTF"}},cn:{translation:{newPlan:"新建方案",savePlan:"保存方案",loadPlan:"加载方案",exportToGltf:"导出为 glTF"}}}});class Me extends n{static DEFAULT_ID="PlanToolbarPlugin";cfg;enabled=!0;constructor(e,t){const n=t?.id||Me.DEFAULT_ID;super(e,{id:n}),this.cfg=t||{id:n},this.init()}setupConfig(e){this.config=e}init(){let e;if(this.cfg.containerId&&(e=document.getElementById(this.cfg.containerId)),!e){const t="planToolbar";e=document.createElement("div"),e.id=t;let n=this.viewer.widgetContainer;n||(n=this.viewer.rootElement),n||(n=document.createElement("div"),n.id="widget-container",document.body.appendChild(n)),n.appendChild(e)}this.initLocalization();const t=document.createElement("a");t.text=Te.t("newPlan"),t.className="btn btn-default btn-sm plan-toolbar-btn",t.addEventListener("click",this.newPlan.bind(this)),e.appendChild(t);const n=document.createElement("a");n.text=Te.t("savePlan"),n.className="btn btn-default btn-sm plan-toolbar-btn",n.addEventListener("click",this.savePlan.bind(this)),e.appendChild(n);const i=document.createElement("a");i.text=Te.t("loadPlan"),i.className="btn btn-default btn-sm plan-toolbar-btn";const o=document.createElement("input");o.type="file",o.multiple=!1,o.accept=".json, .bp3d",o.style.display="none",o.onchange=e=>{const t=e.target.files;!t||t.length<=0?console.error("[PlanToolbar] No files to be uploaded!"):this.loadPlan(t[0])},i.addEventListener("click",(()=>{o.click()})),i.appendChild(o),e.appendChild(i);const r=document.createElement("a");r.className="btn btn-default btn-sm plan-toolbar-btn",r.click=this.exportGltf,r.addEventListener("click",this.exportGltf.bind(this));const s=new Image;s.width=16,s.height=16,s.src="data:image/svg+xml,%3csvg t='1740557986842' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='2091' width='32' height='32'%3e%3cpath d='M512 202.666667a32 32 0 0 0-32-32H256a85.333333 85.333333 0 0 0-85.333333 85.333333v512a85.333333 85.333333 0 0 0 85.333333 85.333333h512a85.333333 85.333333 0 0 0 85.333333-85.333333v-224a32 32 0 0 0-64 0V768a21.333333 21.333333 0 0 1-21.333333 21.333333H256a21.333333 21.333333 0 0 1-21.333333-21.333333V256a21.333333 21.333333 0 0 1 21.333333-21.333333h224a32 32 0 0 0 32-32z' fill='%23666666' p-id='2092'%3e%3c/path%3e%3cpath d='M848.469333 361.258667a8.533333 8.533333 0 0 1-0.085333 12.8l-194.218667 171.178666a8.533333 8.533333 0 0 1-14.165333-6.4V448c0-27.434667-25.898667-10.325333-67.370667-3.029333-44.288 7.722667-124.970667 63.018667-164.906666 92.032-6.954667 5.034667-16.170667-1.92-12.928-9.856 18.773333-45.781333 59.008-135.466667 96.981333-164.48C599.594667 280.362667 640 310.869333 640 283.434667V192.853333a8.533333 8.533333 0 0 1 14.250667-6.314666l194.218666 174.72z' fill='%23666666' p-id='2093'%3e%3c/path%3e%3c/svg%3e",r.append(s),r.title=Te.t("exportToGltf"),e.appendChild(r)}initLocalization(){const e=this.cfg.language||pt;Te.changeLanguage(e)}newPlan(){this.viewer.loadPlan("./plans/new_plan.json")}loadPlan(e){const t=new FileReader;t.onload=e=>{const t=e.target.result;this.viewer.loadPlanFromData(t)},t.readAsArrayBuffer(e)}savePlan(){const e=this.viewer.exportPlan(!1),t=window.document.createElement("a"),n=new Blob([e],{type:"text"});t.href=window.URL.createObjectURL(n),t.download="plan1.json",document.body.appendChild(t),t.click(),document.body.removeChild(t)}exportGltf(){this.viewer.exportGltf("scene")}destroy(){super.destroy()}}class Ae extends e.Mesh{static NAME="SKYBOX";static MIN_SKY_RADIUS=4e3;static MAX_SKY_RADIUS=2e4;vertexShader="\n    varying vec3 vWorldPosition;\n    void main() {\n      vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n      vWorldPosition = worldPosition.xyz;\n      mat4 modifiedViewMatrix = modelViewMatrix;\n      modifiedViewMatrix[3] = vec4(0.0, 0.0, 0.0, 1.0);\n      gl_Position = projectionMatrix * modifiedViewMatrix * vec4( position, 1.0 );\n      gl_Position = gl_Position.xyww;\n    }";fragmentShader="\n    uniform vec3 topColor;\n    uniform vec3 skylineColor;\n    uniform vec3 bottomColor;\n    uniform float offset;\n    uniform float exponent;\n    uniform vec3 skyCenter;\n    uniform vec3 sunDirection;\n    varying vec3 vWorldPosition;\n    // Used to find the position to draw the sun. Sun size is bigger when this value is smaller\n    const float sunDirectionDotThreshold = 0.98;\n\n    void main() {\n      vec3 position = vec3(vWorldPosition.x - skyCenter.x, vWorldPosition.y - skyCenter.y, vWorldPosition.z - skyCenter.z);\n      vec3 normalizedPosition = normalize( position + offset );\n      float h = normalizedPosition.y;\n      vec3 color;\n      if (h > 0.0) {\n        color = mix( skylineColor, topColor, pow( h, exponent ) );\n\n        // draw the sun\n        float dotResult = dot(sunDirection, normalizedPosition);\n        if (dotResult > sunDirectionDotThreshold) {\n            const float sunSize = 1.0 - sunDirectionDotThreshold; // maximum sun size\n            const vec3 sunColor = vec3(1.0, 1.0, 1.0);\n            color = mix(color, sunColor, pow((dotResult + sunSize - 1.0) / sunSize, 3.0));\n        }\n      } else {\n        color = mix( skylineColor, bottomColor, pow( -h, exponent ) );\n      }\n      gl_FragColor = vec4(color , 1.0);\n    }";constructor(t,n,i,o=4e3,r=32,s=15,a=new e.Vector3,c=new e.Vector3(0,.7,.5)){super();const l={topColor:{value:t},skylineColor:{value:n},bottomColor:{value:i},offset:{value:400},exponent:{value:.9},skyCenter:{value:a||new e.Vector3},sunDirection:{value:c.normalize()}};this.geometry=new e.SphereGeometry(o,r,s),this.material=new e.ShaderMaterial({uniforms:l,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,side:e.BackSide}),this.name=Ae.NAME,this.matrixAutoUpdate=!1}}class Ie extends n{static DEFAULT_ID="SkyboxPlugin";enabled=!0;gradientColorSkybox;constructor(e,t){super(e,{id:t?.id||Ie.DEFAULT_ID}),t?.color?this.setSkyboxByColor(t.color):this.setSkyboxByGradientColors()}setupConfig(e){this.config=e}setSkyboxByColor(e=[.92,.95,.96]){this.gradientColorSkybox&&(this.gradientColorSkybox.visible=!1),this.viewer.setBackground(this.rgb2Color(e))}setSkyboxByGradientColors(e=[.52,.71,.96],t=[1,1,1],n=[.6,.6,.6]){this.gradientColorSkybox&&(this.gradientColorSkybox.removeFromParent(),this.gradientColorSkybox=void 0);const i=this.rgb2Color(e),o=this.rgb2Color(t),r=this.rgb2Color(n);this.gradientColorSkybox=new Ae(i,o,r),this.viewer.addObjectToScene(this.gradientColorSkybox)}setSkyboxByCubeTexture(t){this.gradientColorSkybox&&(this.gradientColorSkybox.visible=!1);(new e.CubeTextureLoader).load(t,(e=>{this.viewer.setBackground(e)}))}clearSkybox(){this.gradientColorSkybox?.removeFromParent(),this.gradientColorSkybox=void 0,this.viewer.setBackground(null)}destroy(){super.destroy(),this.gradientColorSkybox?.removeFromParent(),this.gradientColorSkybox=void 0,this.viewer.setBackground(null)}rgb2Color(t){const n=t[0]||0,i=t[1]||0,o=t[2]||0,r=new e.Color;return r.setRGB(n,i,o),r}}l("#toolbar{bottom:20px;display:block;position:absolute;right:20px}.toolbar-btn{margin-right:3px}.btn{background-image:none;border:1px solid transparent;border-radius:4px;cursor:pointer;display:inline-block;font-size:14px;font-weight:400;line-height:1.42857143;margin-bottom:0;padding:6px 12px;text-align:center;-ms-touch-action:manipulation;touch-action:manipulation;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap}.btn-default{background-color:#fff;border-color:#ccc;color:#333}.btn-default:hover{background-color:#e6e6e6;border-color:#adadad;color:#333}.btn-group,.btn-group-vertical{display:inline-block;position:relative;vertical-align:middle;width:37px}.btn-group-vertical>.btn:first-child:not(:last-child){border-bottom-left-radius:0;border-bottom-right-radius:0;border-top-right-radius:4px}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group,.btn-group-vertical>.btn-group>.btn{display:block;float:none;max-width:100%;width:100%}.btn-group-vertical>.btn,.btn-group>.btn{float:left;position:relative}.btn-group-sm>.btn,.btn-sm{border-radius:3px;font-size:12px;line-height:1.5;padding:5px 10px}");l("input[type=checkbox]{cursor:pointer}input[type=button],input[type=text]{border:1px solid gray;padding:0 2px}input[type=button]{cursor:pointer;margin-left:1px}table{margin:5px;width:calc(100% - 10px)}.panel-container{background-color:hsla(0,0%,100%,.9);border-radius:4px;box-shadow:1px 3px 10px 0 rgba(0,0,0,.4);height:auto;left:calc(50% - 165px);overflow:hidden;position:absolute;top:20%;width:330px;z-index:1}.panel-container:hover{background-color:hsla(0,0%,100%,.95)}.panel-hide{visibility:hidden}.panel-close-btn{cursor:pointer;font-size:16px;position:absolute;right:20px;top:10px}.panel-close-btn:hover{color:#0032ff}.panel-header{align-items:center;background-color:#00000022;border-bottom:1px solid #ccc;cursor:move;display:flex;height:40px;padding-left:12px;width:100%}.panel-body{margin:3px;width:100%}.color-input{border:1px solid gray;cursor:pointer;font-size:0;height:16px;margin:2px;width:24px}.bim-setting{list-style:none;padding:2px}.bim-setting li{list-style:none;margin:2px;padding:8px}.bim-setting li:hover{box-shadow:0 4px 8px rgba(0,0,0,.1)}.bim-setting span{display:inline-block;margin-right:5px;width:50%}.bim-setting select{border:1px solid #000}");class Ne{viewer;parentContainer;panel;closeBtn;skyboxPlugin;groundGridPlugin;mouseDownPositionX=-1;mouseDownPositionY=-1;constructor(e){this.viewer=e,this.parentContainer=this.viewer.getRootContainer(),this.skyboxPlugin=e.findPlugin("SkyboxPlugin"),this.skyboxPlugin||console.warn("[Settings] SkyboxPlugin doesn't seem to be installed!"),this.groundGridPlugin=e.findPlugin("GroundGridPlugin"),this.groundGridPlugin||console.warn("[Settings] GroundGridPlugin doesn't seem to be installed!"),this.buildPage(),this.addEventHandlers()}isVisible(){return!this.panel.classList.contains("panel-hide")}show(){this.isVisible()||this.panel?.classList.remove("panel-hide")}hide(){this.isVisible()&&this.panel?.classList.add("panel-hide")}destroy(){this.panel?.remove()}buildPage(){this.panel=document.createElement("div"),this.panel.classList.add("panel-container","panel-hide");const e=document.createElement("div");e.innerText="Settings",e.classList.add("panel-header","draggable"),this.panel.appendChild(e);const t=document.createElement("span");t.classList.add("panel-close-btn"),t.innerHTML="X",e.appendChild(t),this.closeBtn=t,this.buildContent(),this.parentContainer.appendChild(this.panel)}buildContent(){const e=this.viewer.isSelectionEnabled(),t=this.viewer.isSnapEnabled(),n=this.viewer.isWallExteriorVisible(),i=this.viewer.isRoofVisible(),o=this.groundGridPlugin?.isVisible(),r=this.viewer.isAxesHelperVisible(),s=document.createElement("div");s.innerHTML=`\n            <ul class="bim-setting">\n                <li>\n                    <span>Skybox</span>\n                    <select id="selectSkybox">\n                        <option value="">None</option>\n                        <option value="white">White</option>\n                        <option value="black">Black</option>\n                        <option value="gray">Gray</option>\n                        <option value="gradientBlueGray">Blue/Gray</option>\n                        <option value="gradientDarkBlueGray">DarkBlue/Gray</option>\n                        <option value="gradientBlueYellow">Blue/Yellow</option>\n                    </select>\n                </li>\n                <li>\n                    <span>Enable Selection/Edit</span>\n                    <input id="selectionEnabled" type="checkbox" ${e?"checked":""}>\n                </li>\n                <li>\n                    <span>Enable Snap</span>\n                    <input id="snapEnabled" type="checkbox" ${t?"checked":""}>\n                </li>\n                <li>\n                    <span>Show Wall exterior</span>\n                    <input id="wallExteriorVisible" type="checkbox" ${n?"checked":""}>\n                </li>\n                <li>\n                    <span>Show Roof</span>\n                    <input id="roofVisible" type="checkbox" ${i?"checked":""}>\n                </li>\n                <li>\n                    <span>Show Ground grid</span>\n                    <input id="groundGridVisible" type="checkbox" ${this.groundGridPlugin?"":"disabled"} ${o?"checked":""}>\n                </li>\n                <li>\n                    <span>Show AxesHelper</span>\n                    <input id="axesHelperVisible" type="checkbox" ${r?"checked":""}>\n                </li>\n            </ul>\n        `,this.panel.appendChild(s)}addEventHandlers(){this.closeBtn?.addEventListener("click",this.hide.bind(this)),this.panel?.addEventListener("pointerdown",this.onPointerDown);document.getElementById("selectSkybox").addEventListener("change",(e=>{const t=e.target;if(!t.selectedOptions||0==t.selectedOptions.length)return;const n=t.selectedOptions[0].value;""===n?this.skyboxPlugin.clearSkybox():"white"===n?this.skyboxPlugin.setSkyboxByColor([1,1,1]):"black"===n?this.skyboxPlugin.setSkyboxByColor([0,0,0]):"gray"===n?this.skyboxPlugin.setSkyboxByColor([.5,.5,.5]):"gradientBlueGray"===n?this.skyboxPlugin.setSkyboxByGradientColors([.52,.71,.96],[1,1,1],[.6,.6,.6]):"gradientDarkBlueGray"===n?this.skyboxPlugin.setSkyboxByGradientColors([.66,.93,1],[1,1,1],[.41,.41,.41]):"gradientBlueYellow"===n&&this.skyboxPlugin.setSkyboxByGradientColors([.86,.93,1],[1,1,1],[.92,.89,.79]),this.viewer.setNeedsUpdate()}));document.getElementById("selectionEnabled").addEventListener("change",(e=>{if(e&&e.target){const t=e.target.checked;this.viewer.enableSelection(t)}}));document.getElementById("snapEnabled").addEventListener("change",(e=>{if(e&&e.target){const t=e.target.checked;this.viewer.enableSnap(t)}}));document.getElementById("wallExteriorVisible").addEventListener("change",(e=>{if(e&&e.target){const t=e.target.checked;this.viewer.setWallExteriorVisible(t)}}));document.getElementById("roofVisible").addEventListener("change",(e=>{if(e&&e.target){const t=e.target.checked;this.viewer.setRoofVisible(t)}}));document.getElementById("groundGridVisible").addEventListener("change",(e=>{if(e&&e.target&&this.groundGridPlugin){const t=e.target.checked;this.groundGridPlugin.setVisible(t)}}));document.getElementById("axesHelperVisible").addEventListener("change",(e=>{if(e&&e.target){const t=e.target.checked;this.viewer.setAxesHelperVisible(t)}}))}onPointerDown=e=>{e.stopPropagation();const t=e.target;t?.classList.contains("draggable")&&0===e.button&&(this.mouseDownPositionX=e.x,this.mouseDownPositionY=e.y,document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp))};onPointerMove=e=>{e.preventDefault(),e.stopPropagation();const t=this.panel,n=this.viewer.getViewerContainer();if(!t||!n)return;const i=n.clientLeft+n.clientWidth,o=n.clientTop+n.clientHeight,r=e.x-this.mouseDownPositionX,s=e.y-this.mouseDownPositionY;let a=t.offsetLeft+r,c=t.offsetTop+s;a<0&&(a=0),a>0&&a+t.clientWidth>i&&r>0&&(a=t.offsetLeft),c<0&&(c=0),c>0&&c+t.clientHeight>o&&s>0&&(c=t.offsetTop),t.style.left=`${a}px`,t.style.top=`${c}px`,this.mouseDownPositionX=e.x,this.mouseDownPositionY=e.y};onPointerUp=e=>{e.preventDefault(),e.stopPropagation(),document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp)}}const Ve=Pe.createInstance();var je;Ve.init({lng:"en",debug:!1,resources:{en:{translation:{zoomOut:"Zoom Out",homeView:"Home View",zoomIn:"Zoom In",takeScreenshot:"Take Screenshot",setting:"Setting",moveLeft:"Move Left",moveUp:"Move Up",moveDown:"Move Down",moveRight:"Move Right"}},cn:{translation:{zoomOut:"缩小",homeView:"主视图",zoomIn:"放大",takeScreenshot:"获取截屏",setting:"设置",moveLeft:"左移视图",moveUp:"上移视图",moveDown:"下移视图",moveRight:"右移视图"}}}}),function(e){e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right"}(je||(je={}));class Fe extends n{static DEFAULT_ID="ToolbarPlugin";cfg;enabled=!0;panDistance=1;zoomDistance=1;settingPanel;constructor(e,t){const n=t?.id||Fe.DEFAULT_ID;super(e,{id:n}),this.cfg=t||{id:n},this.init()}setupConfig(e){this.config=e}init(){let e;if(this.cfg.containerId&&(e=document.getElementById(this.cfg.containerId)),!e){const t="toolbar";e=document.createElement("div"),e.id=t;let n=this.viewer.widgetContainer;n||(n=this.viewer.rootElement),n||(n=document.createElement("div"),n.id="widget-container",document.body.appendChild(n)),n.appendChild(e)}this.initLocalization();const t=(t,n=e,i="")=>{const o=document.createElement("a");o.className="btn btn-default btn-sm toolbar-btn";const r=new Image;return r.width=16,r.height=16,r.src=t,o.append(r),o.title=i,n.appendChild(o),o},n=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M945.066667 898.133333l-189.866667-189.866666c55.466667-64 87.466667-149.333333 87.466667-241.066667 0-204.8-168.533333-373.333333-373.333334-373.333333S96 264.533333 96 469.333333 264.533333 842.666667 469.333333 842.666667c91.733333 0 174.933333-34.133333 241.066667-87.466667l189.866667 189.866667c6.4 6.4 14.933333 8.533333 23.466666 8.533333s17.066667-2.133333 23.466667-8.533333c8.533333-12.8 8.533333-34.133333-2.133333-46.933334zM469.333333 778.666667C298.666667 778.666667 160 640 160 469.333333S298.666667 160 469.333333 160 778.666667 298.666667 778.666667 469.333333 640 778.666667 469.333333 778.666667z' /%3e%3cpath fill='%232c2c2c' d='M597.333333 437.333333H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h256c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z' /%3e%3c/svg%3e",e,Ve.t("zoomOut")),i=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M923.733333 394.666667c-85.333333-70.4-206.933333-174.933333-362.666666-309.333334C533.333333 61.866667 490.666667 61.866667 462.933333 85.333333c-155.733333 134.4-277.333333 238.933333-362.666666 309.333334-14.933333 14.933333-25.6 34.133333-25.6 53.333333 0 38.4 32 70.4 70.4 70.4H192v358.4c0 29.866667 23.466667 53.333333 53.333333 53.333333H405.333333c29.866667 0 53.333333-23.466667 53.333334-53.333333v-206.933333h106.666666v206.933333c0 29.866667 23.466667 53.333333 53.333334 53.333333h160c29.866667 0 53.333333-23.466667 53.333333-53.333333V518.4h46.933333c38.4 0 70.4-32 70.4-70.4 0-21.333333-10.666667-40.533333-25.6-53.333333z m-44.8 59.733333h-57.6c-29.866667 0-53.333333 23.466667-53.333333 53.333333v358.4h-138.666667V661.333333c0-29.866667-23.466667-53.333333-53.333333-53.333333h-128c-29.866667 0-53.333333 23.466667-53.333333 53.333333v206.933334H256V507.733333c0-29.866667-23.466667-53.333333-53.333333-53.333333H145.066667c-4.266667 0-6.4-2.133333-6.4-6.4 0-2.133333 2.133333-4.266667 2.133333-6.4 85.333333-70.4 206.933333-174.933333 362.666667-309.333333 4.266667-4.266667 10.666667-4.266667 14.933333 0 155.733333 134.4 277.333333 238.933333 362.666667 309.333333 2.133333 2.133333 2.133333 2.133333 2.133333 4.266667 2.133333 6.4-2.133333 8.533333-4.266667 8.533333z' /%3e%3c/svg%3e",e,Ve.t("homeView")),o=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M945.066667 898.133333l-189.866667-189.866666c55.466667-64 87.466667-149.333333 87.466667-241.066667 0-204.8-168.533333-373.333333-373.333334-373.333333S96 264.533333 96 469.333333 264.533333 842.666667 469.333333 842.666667c91.733333 0 174.933333-34.133333 241.066667-87.466667l189.866667 189.866667c6.4 6.4 14.933333 8.533333 23.466666 8.533333s17.066667-2.133333 23.466667-8.533333c8.533333-12.8 8.533333-34.133333-2.133333-46.933334zM469.333333 778.666667C298.666667 778.666667 160 640 160 469.333333S298.666667 160 469.333333 160 778.666667 298.666667 778.666667 469.333333 640 778.666667 469.333333 778.666667z' /%3e%3cpath fill='%232c2c2c' d='M597.333333 437.333333h-96V341.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v96H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h96V597.333333c0 17.066667 14.933333 32 32 32s32-14.933333 32-32v-96H597.333333c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z' /%3e%3c/svg%3e",e,Ve.t("zoomIn")),r=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M846.933333 238.933333h-140.8L646.4 149.333333c-6.4-10.666667-17.066667-17.066667-29.866667-17.066666h-209.066666c-12.8 0-23.466667 6.4-29.866667 17.066666l-59.733333 89.6H177.066667c-57.6 0-106.666667 46.933333-106.666667 106.666667v426.666667c0 57.6 46.933333 106.666667 106.666667 106.666666h672c57.6 0 106.666667-46.933333 106.666666-106.666666v-426.666667c-2.133333-59.733333-49.066667-106.666667-108.8-106.666667z m34.133334 533.333334c0 19.2-14.933333 34.133333-34.133334 34.133333H177.066667c-19.2 0-34.133333-14.933333-34.133334-34.133333v-426.666667c0-19.2 14.933333-34.133333 34.133334-34.133333h160c12.8 0 23.466667-6.4 29.866666-17.066667L426.666667 206.933333h170.666666l59.733334 89.6c6.4 10.666667 17.066667 17.066667 29.866666 17.066667h160c19.2 0 34.133333 14.933333 34.133334 34.133333v424.533334z' /%3e%3cpath fill='%232c2c2c' d='M512 364.8c-96 0-174.933333 78.933333-174.933333 174.933333 0 96 78.933333 174.933333 174.933333 174.933334 96 0 174.933333-78.933333 174.933333-174.933334 0-96-78.933333-174.933333-174.933333-174.933333z m0 279.466667c-57.6 0-104.533333-46.933333-104.533333-104.533334s46.933333-104.533333 104.533333-104.533333 104.533333 46.933333 104.533333 104.533333-46.933333 104.533333-104.533333 104.533334z' /%3e%3c/svg%3e",e,Ve.t("takeScreenshot")),s=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M904.533333 422.4l-85.333333-14.933333-17.066667-38.4 49.066667-70.4c14.933333-21.333333 12.8-49.066667-6.4-68.266667l-53.333333-53.333333c-19.2-19.2-46.933333-21.333333-68.266667-6.4l-70.4 49.066666-38.4-17.066666-14.933333-85.333334c-2.133333-23.466667-23.466667-42.666667-49.066667-42.666666h-74.666667c-25.6 0-46.933333 19.2-53.333333 44.8l-14.933333 85.333333-38.4 17.066667L296.533333 170.666667c-21.333333-14.933333-49.066667-12.8-68.266666 6.4l-53.333334 53.333333c-19.2 19.2-21.333333 46.933333-6.4 68.266667l49.066667 70.4-17.066667 38.4-85.333333 14.933333c-21.333333 4.266667-40.533333 25.6-40.533333 51.2v74.666667c0 25.6 19.2 46.933333 44.8 53.333333l85.333333 14.933333 17.066667 38.4L170.666667 727.466667c-14.933333 21.333333-12.8 49.066667 6.4 68.266666l53.333333 53.333334c19.2 19.2 46.933333 21.333333 68.266667 6.4l70.4-49.066667 38.4 17.066667 14.933333 85.333333c4.266667 25.6 25.6 44.8 53.333333 44.8h74.666667c25.6 0 46.933333-19.2 53.333333-44.8l14.933334-85.333333 38.4-17.066667 70.4 49.066667c21.333333 14.933333 49.066667 12.8 68.266666-6.4l53.333334-53.333334c19.2-19.2 21.333333-46.933333 6.4-68.266666l-49.066667-70.4 17.066667-38.4 85.333333-14.933334c25.6-4.266667 44.8-25.6 44.8-53.333333v-74.666667c-4.266667-27.733333-23.466667-49.066667-49.066667-53.333333z m-19.2 117.333333l-93.866666 17.066667c-10.666667 2.133333-19.2 8.533333-23.466667 19.2l-29.866667 70.4c-4.266667 10.666667-2.133333 21.333333 4.266667 29.866667l53.333333 76.8-40.533333 40.533333-76.8-53.333333c-8.533333-6.4-21.333333-8.533333-29.866667-4.266667L576 768c-10.666667 4.266667-17.066667 12.8-19.2 23.466667l-17.066667 93.866666h-57.6l-17.066666-93.866666c-2.133333-10.666667-8.533333-19.2-19.2-23.466667l-70.4-29.866667c-10.666667-4.266667-21.333333-2.133333-29.866667 4.266667l-76.8 53.333333-40.533333-40.533333 53.333333-76.8c6.4-8.533333 8.533333-21.333333 4.266667-29.866667L256 576c-4.266667-10.666667-12.8-17.066667-23.466667-19.2l-93.866666-17.066667v-57.6l93.866666-17.066666c10.666667-2.133333 19.2-8.533333 23.466667-19.2l29.866667-70.4c4.266667-10.666667 2.133333-21.333333-4.266667-29.866667l-53.333333-76.8 40.533333-40.533333 76.8 53.333333c8.533333 6.4 21.333333 8.533333 29.866667 4.266667L448 256c10.666667-4.266667 17.066667-12.8 19.2-23.466667l17.066667-93.866666h57.6l17.066666 93.866666c2.133333 10.666667 8.533333 19.2 19.2 23.466667l70.4 29.866667c10.666667 4.266667 21.333333 2.133333 29.866667-4.266667l76.8-53.333333 40.533333 40.533333-53.333333 76.8c-6.4 8.533333-8.533333 21.333333-4.266667 29.866667L768 448c4.266667 10.666667 12.8 17.066667 23.466667 19.2l93.866666 17.066667v55.466666z' /%3e%3cpath fill='%232c2c2c' d='M512 394.666667c-64 0-117.333333 53.333333-117.333333 117.333333s53.333333 117.333333 117.333333 117.333333 117.333333-53.333333 117.333333-117.333333-53.333333-117.333333-117.333333-117.333333z m0 170.666666c-29.866667 0-53.333333-23.466667-53.333333-53.333333s23.466667-53.333333 53.333333-53.333333 53.333333 23.466667 53.333333 53.333333-23.466667 53.333333-53.333333 53.333333z' /%3e%3c/svg%3e",e,Ve.t("setting")),a=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z' /%3e%3c/svg%3e",e,Ve.t("moveLeft")),c=document.createElement("span");c.className="btn-group-vertical",e.appendChild(c);const l=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M904.533333 674.133333l-362.666666-362.666666c-17.066667-17.066667-42.666667-17.066667-59.733334 0l-362.666666 362.666666c-17.066667 17.066667-17.066667 42.666667 0 59.733334 17.066667 17.066667 42.666667 17.066667 59.733333 0L512 401.066667l332.8 332.8c8.533333 8.533333 19.2 12.8 29.866667 12.8s21.333333-4.266667 29.866666-12.8c17.066667-17.066667 17.066667-42.666667 0-59.733334z' /%3e%3c/svg%3e",c,Ve.t("moveUp")),d=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M904.533333 311.466667c-17.066667-17.066667-42.666667-17.066667-59.733333 0L512 644.266667 179.2 311.466667c-17.066667-17.066667-42.666667-17.066667-59.733333 0-17.066667 17.066667-17.066667 42.666667 0 59.733333l362.666666 362.666667c8.533333 8.533333 19.2 12.8 29.866667 12.8s21.333333-4.266667 29.866667-12.8l362.666666-362.666667c17.066667-17.066667 17.066667-42.666667 0-59.733333z' /%3e%3c/svg%3e",c,Ve.t("moveDown")),h=t("data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg class='icon' width='32px' height='32.00px' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%232c2c2c' d='M731.733333 480l-384-341.333333c-17.066667-14.933333-44.8-14.933333-59.733333 4.266666-14.933333 17.066667-14.933333 44.8 4.266667 59.733334L640 512 292.266667 821.333333c-17.066667 14.933333-19.2 42.666667-4.266667 59.733334 8.533333 8.533333 19.2 14.933333 32 14.933333 10.666667 0 19.2-4.266667 27.733333-10.666667l384-341.333333c8.533333-8.533333 14.933333-19.2 14.933334-32s-4.266667-23.466667-14.933334-32z' /%3e%3c/svg%3e",e,Ve.t("moveRight"));n.onclick=this.zoomOut.bind(this),i.onclick=this.goToHomeView.bind(this),o.onclick=this.zoomIn.bind(this),r.onclick=this.getScreenshot.bind(this),s.onclick=this.setting.bind(this),a.onclick=this.pan(je.Left).bind(this),l.onclick=this.pan(je.Up).bind(this),d.onclick=this.pan(je.Down).bind(this),h.onclick=this.pan(je.Right).bind(this)}initLocalization(){const e=this.cfg.language||pt;Ve.changeLanguage(e)}preventDefault(e){e.preventDefault(),e.stopPropagation()}pan(e){const t=this.viewer;return()=>{switch(e){case je.Up:t.truck(0,this.panDistance,!0);break;case je.Down:t.truck(0,-this.panDistance,!0);break;case je.Left:t.truck(this.panDistance,0,!0);break;case je.Right:t.truck(-this.panDistance,0,!0)}}}zoomIn(e){e.preventDefault(),this.viewer.zoomIn(this.zoomDistance)}zoomOut(e){e.preventDefault(),this.viewer.zoomOut(this.zoomDistance)}goToHomeView(e){e.preventDefault(),this.viewer.goToHomeView()}getScreenshot(e){e.preventDefault();const t=this.viewer.getScreenshot(),n=window.document.createElement("a");n.href=t,n.download="screenshot.png",n.click()}setting(e){if(e.preventDefault(),!this.settingPanel)return this.settingPanel=new Ne(this.viewer),void this.settingPanel.show();this.settingPanel.isVisible()?this.settingPanel.hide():this.settingPanel.show()}destroy(){super.destroy()}}l("#transform{background-color:#f9f9f9;border-radius:4px;box-shadow:0 4px 8px #0000003a;display:block;left:45%;padding:1px;position:absolute;top:20px}.transform-btn{background:#ffffff88;border:2px solid #31bd5900;border-radius:4px;cursor:pointer;display:inline-flex;margin:0 2px;padding:4px}.transform-btn:hover{box-shadow:0 4px 8px #0000003a}.checked{border:2px solid #31bd59}.disabled{cursor:not-allowed;opacity:.3}.transform-draggable-btn{background:#ffffff88;border:2px solid #31bd5900;cursor:move;display:inline-flex;padding:4px}.transform-dropdown-content{background-color:#f9f9f9;border-radius:4px;box-shadow:0 4px 8px #0000003a;display:none;margin-left:12px;margin-top:-1px;min-width:120px;padding:1px;position:absolute;top:100%;transform:translateX(-50%);width:fit-content;z-index:1}.transform-dropdown-content-title{align-items:center;display:flex;font-size:16px;font-weight:700;justify-content:center;padding:4px;white-space:nowrap}.transform-dropdown-item{align-items:center;border:2px solid #31bd5900;border-radius:4px;cursor:pointer;display:flex;gap:6px;justify-content:left;padding:2px;white-space:nowrap}.transform-dropdown-item-icon{align-items:center;cursor:pointer;display:inline-flex;justify-content:center;padding:2px}.transform-dropdown-item:hover{background-color:#ddd}.transform-btn:hover .transform-dropdown-content{display:block}");const He=Pe.createInstance();He.init({lng:"en",debug:!1,resources:{en:{translation:{enableSelection:"Enable/Disable Selection",localSpace:"Local Space",worldSpace:"World Space",translate:"Translate (R)",rotate:"Rotate (R)",scale:"Scale (R)",transform:"Transform",flip:"Flip",flipHorizontal:"Flip Horizontal",flipVertivally:"Flip Vertivally",delete:"Delete",lock:"Lock In Place",snapPrecision:"Snap Precision",disableSnap:"Disable Snap",high:"High",medium:"Medium",low:"Low"}},cn:{translation:{enableSelection:"启用/禁用构件选择",localSpace:"局部坐标系",worldSpace:"世界坐标系",translate:"移动 (R)",rotate:"旋转 (R)",scale:"缩放 (R)",transform:"切换控件",flip:"翻转",flipHorizontal:"左右翻转",flipVertivally:"前后翻转",delete:"删除",lock:"锁定",snapPrecision:"吸附精度",disableSnap:"关闭吸附",high:"高",medium:"中",low:"低"}}}});const _e='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n        PATH\n    </svg>',Ue='<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24 6V42" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M4 34L16 12V34H4Z" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/><path d="M44 34H32V12L44 34Z" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/></svg>',ze='<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="22" width="36" height="22" rx="2" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/><path d="M14 22V14C14 8.47715 18.4772 4 24 4C29.5228 4 34 8.47715 34 14V22" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M24 30V36" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',Ge='<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="7" y="22.0476" width="34" height="22" rx="2" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/><path d="M14 22V14.0047C13.9948 8.87022 17.9227 4.56718 23.0859 4.05117C28.249 3.53516 32.9673 6.97408 34 12.0059" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M24 30V36" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',We='<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H39C40.6569 42 42 40.6569 42 39V9C42 7.34315 40.6569 6 39 6Z" fill="none" stroke="#333" stroke-width="2"/></svg>',Ke='<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="5" width="38" height="38" rx="2" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M24 5V43" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M5 24H43" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',Xe='<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="5" width="38" height="38" rx="2" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M5 18H43" stroke="#333" stroke-width="2" stroke-linecap="round"/><path d="M5 30H43" stroke="#333" stroke-width="2" stroke-linecap="round"/><path d="M17 5V43" stroke="#333" stroke-width="2" stroke-linecap="round"/><path d="M30 5V43" stroke="#333" stroke-width="2" stroke-linecap="round"/></svg>',Ye='<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="4" width="40" height="40" rx="2" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M14 4V44" stroke="#333" stroke-width="2" stroke-linecap="round"/><path d="M24 4V44" stroke="#333" stroke-width="2" stroke-linecap="round"/><path d="M34 4V44" stroke="#333" stroke-width="2" stroke-linecap="round"/><path d="M4 14H44" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M4 34H44" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M4 24H44" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',$e=_e.replace("PATH",'<path d="M2,1 L3,19 L9,12 L17,12 L2,1" fill="none" stroke="#333C4E" stroke-width="1"/>'),Ze=_e.replace("PATH",'<path d="M9,10 A 1 1 180 0 1 11 10 M11,10 A 1 1 180 0 1 9 10 M9,10 L1,10 M10.4,9.2 L15,2 M10.4,10.8 L15,18" fill="none" stroke="#333C4E" stroke-width="1"/>'),qe=_e.replace("PATH",'<path d="M2,2 L2,18 L18,18 M2,18 L9,9" fill="none" stroke="#333C4E" stroke-width="1"/>'),Je=_e.replace("PATH",'<path d="M2,10 L18,10 M10,2 L10,18 M4,8 L2,10 L4,12 M16,8 L18,10 L 16,12 M8,4 L10,2 L12,4 M8,16 L10,18 L12,16" fill="none" stroke="#333C4E" stroke-width="1"/>'),Qe=_e.replace("PATH",'<path d="M2,10 A 8 8 150 0 1 17 6 M18,10 A 8 8 150 0 1 3 14 M1,7 L2,10 L4,7.5 M19,13 L18,10 L16,12.5" fill="none" stroke="#333C4E" stroke-width="1"/>'),et=_e.replace("PATH",'<path d="M10,2 L18,2 L18,10 M 18,2 L2,18 L10,18 M2,18 L2, 10" fill="none" stroke="#333C4E" stroke-width="1"/>');var tt;!function(e){e[e.None=0]="None",e[e.High=1]="High",e[e.Medium=2]="Medium",e[e.Low=3]="Low"}(tt||(tt={}));class nt extends n{static DEFAULT_ID="TransformPlugin";cfg;enabled=!0;transformBtn;lockBtn;snapBtn;flipBtn;deleteBtn;spaceBtn;constructor(e,t){const n=t?.id||nt.DEFAULT_ID;super(e,{id:n}),this.cfg=t||{id:n},this.init()}setupConfig(e){this.config=e}init(){let e;if(this.cfg.containerId&&(e=document.getElementById(this.cfg.containerId)),!e){const t="transform";e=document.createElement("div"),e.id=t;let n=this.viewer.widgetContainer;n||(n=this.viewer.rootElement),n||(n=document.createElement("div"),n.id="widget-container",document.body.appendChild(n)),n.appendChild(e)}this.initLocalization(),this.addDraggableBtn(e);const t=this.addBtn($e,e,He.t("enableSelection"));t.onclick=this.toggleSelection.bind(this);const n=this.addBtn(qe,e,He.t("worldSpace"));n.onclick=this.toggleSpace.bind(this),this.setButtonChecked(t,this.viewer.isSelectionEnabled());const i=this.addDropDownBtn(Je,e,He.t("transform")),o=this.addDropdownContent(i,He.t("transform")),r=this.addDropDownItem(Je,He.t("translate"),o),s=this.addDropDownItem(Qe,He.t("rotate"),o),a=this.addDropDownItem(et,He.t("scale"),o);r.onclick=e=>{this.preventDefault(e),this.setTranslate()},s.onclick=e=>{this.preventDefault(e),this.setRotate()},a.onclick=e=>{this.preventDefault(e),this.setScale()};const c=this.addDropDownBtn(Ue,e,He.t("flip")),l=this.addDropdownContent(c,He.t("flip")),d=this.addDropDownItem(Ue,He.t("flipHorizontal"),l),h=this.addDropDownItem('<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M42 24L6 24" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M14 4L36 16H14V4Z" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/><path d="M14 44V32H36L14 44Z" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/></svg>',He.t("flipVertivally"),l);d.onclick=this.flipByXAxis.bind(this),h.onclick=this.flipByZAxis.bind(this);const u=this.addBtn('<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 10V44H39V10H9Z" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/><path d="M20 20V33" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M28 20V33" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M4 10H44" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 10L19.289 4H28.7771L32 10H16Z" fill="none" stroke="#333" stroke-width="2" stroke-linejoin="round"/></svg>',e,He.t("delete"));u.onclick=this.deleteEntity.bind(this);const p=this.addBtn(ze,e,He.t("lock"));p.onclick=this.lockEntity.bind(this);const g=this.addDropDownBtn(Ke,e,He.t("snapPrecision")),f=this.addDropdownContent(g,He.t("snapPrecision")),m=this.addDropDownItem(We,He.t("disableSnap"),f),v=this.addDropDownItem(Ke,He.t("high"),f),w=this.addDropDownItem(Xe,He.t("medium"),f),b=this.addDropDownItem(Ye,He.t("low"),f);m.onclick=e=>{this.preventDefault(e),this.setSnapConfig(tt.None),this.setButtonChecked(m,!0),this.setButtonChecked(v,!1),this.setButtonChecked(w,!1),this.setButtonChecked(b,!1)},v.onclick=e=>{this.preventDefault(e),this.setSnapConfig(tt.High),this.setButtonChecked(m,!1),this.setButtonChecked(v,!0),this.setButtonChecked(w,!1),this.setButtonChecked(b,!1)},w.onclick=e=>{this.preventDefault(e),this.setSnapConfig(tt.Medium),this.setButtonChecked(m,!1),this.setButtonChecked(v,!1),this.setButtonChecked(w,!0),this.setButtonChecked(b,!1)},b.onclick=e=>{this.preventDefault(e),this.setSnapConfig(tt.Low),this.setButtonChecked(m,!1),this.setButtonChecked(v,!1),this.setButtonChecked(w,!1),this.setButtonChecked(b,!0)},this.transformBtn=i,this.lockBtn=p,this.snapBtn=g,this.flipBtn=c,this.deleteBtn=u,this.spaceBtn=n;const y=this.viewer;y&&(y.entitySelectedCallbacks.add((e=>{this.onEntitySelected(e)})),y.entityUnselectedCallbacks.add((()=>{this.onEntityUnselected()}))),window.addEventListener("keydown",this.onKeyDown)}initLocalization(){const e=this.cfg.language||pt;He.changeLanguage(e)}preventDefault(e){e.preventDefault(),e.stopPropagation()}setButtonChecked(e,t){const n="checked";t?e.classList.add(n):e.classList.remove(n)}toggleSelection(e){this.preventDefault(e);const t=!this.viewer.isSelectionEnabled();this.viewer.enableSelection(t);const n=e.currentTarget;this.setButtonChecked(n,t)}toggleSpace(e){this.preventDefault(e);let t=this.viewer.getTransformSpace();t||(t=r.World,this.viewer.setTransformSpace(t));const n=t===r.Local?r.World:r.Local,i=e.currentTarget;n===r.Local?(i.innerHTML=Ze,i.title=He.t("localSpace")):(i.innerHTML=qe,i.title=He.t("worldSpace")),this.viewer.setTransformSpace(n)}setTranslate(){this.updateTransformButtonStates(s.Translate)}setRotate(){this.updateTransformButtonStates(s.Rotate)}setScale(){this.updateTransformButtonStates(s.Scale)}setButtonEnabled(e,t){const n="disabled";t?e.classList.remove(n):e.classList.add(n)}addBtn(e,t,n=""){const i=document.createElement("div");return i.className="transform-btn",i.innerHTML=e,i.title=n,t.appendChild(i),i}addDropDownItem(e,t,n){const i=document.createElement("div");return i.className="transform-dropdown-item",i.innerHTML=`\n            ${e}\n            <span>${t}</span>\n        `,n.appendChild(i),i}addDropdownContent(e,t){const n=document.createElement("div");return n.className="transform-dropdown-content",n.innerHTML=`\n        <div class="transform-dropdown-content-title">\n        ${t}\n        </div>\n        `,e.appendChild(n),n}addDropDownBtn(e,t,n=""){const i=document.createElement("div");return i.className="transform-btn",i.title=n,i.innerHTML=e,t.appendChild(i),i}addDraggableBtn(e){const t=this.addBtn('<svg width="8" height="20" viewBox="0 0 24 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M19 10C19 12.2091 17.2091 14 15 14C12.7909 14 11 12.2091 11 10C11 7.79086 12.7909 6 15 6C17.2091 6 19 7.79086 19 10ZM15 28C17.2091 28 19 26.2091 19 24C19 21.7909 17.2091 20 15 20C12.7909 20 11 21.7909 11 24C11 26.2091 12.7909 28 15 28ZM15 42C17.2091 42 19 40.2091 19 38C19 35.7909 17.2091 34 15 34C12.7909 34 11 35.7909 11 38C11 40.2091 12.7909 42 15 42Z" fill="#333"/></svg>',e,"");t.className="transform-draggable-btn",document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("transform");let n=!1,i=0,o=0;e&&(t.addEventListener("mousedown",(function(t){n=!0,i=t.clientX-e.offsetLeft,o=t.clientY-e.offsetTop})),document.addEventListener("mousemove",(function(t){n&&(e.style.left=t.clientX-i+"px",e.style.top=t.clientY-o+"px")})),document.addEventListener("mouseup",(function(){n=!1})))}))}setButtonIcon(e,t,n){const i=document.createElement("template");i.innerHTML=t,n&&(i.title=n);const o=i.content.firstChild;o&&e.firstChild&&e.replaceChild(o,e.firstChild)}flipByXAxis(e){this.preventDefault(e);const t=this.viewer.getSelectedEntity();t&&t.setScale(-1,1,1)}flipByZAxis(e){this.preventDefault(e);const t=this.viewer.getSelectedEntity();t&&t.setScale(1,1,-1)}deleteEntity(e){this.preventDefault(e);const t=this.viewer.getSelectedEntity();t&&this.viewer.removeEntity(t)}lockEntity(e){this.preventDefault(e);const t=this.viewer.getSelectedEntity();t&&t.setFixed(!t.fixed),this.lockBtn&&this.setButtonIcon(this.lockBtn,t.fixed?Ge:ze),this.onEntitySelected(this.viewer.getSelectedEntity())}setSnapConfig(e){const t=this.viewer;if(!t)return;const n={};let i=We;switch(e){case tt.None:n.snapEnabled=!1,n.gizmoTranslationSnap=0,n.gizmoRotationSnap=0,n.gizmoScaleSnap=0,i=We;break;case tt.High:n.snapEnabled=!0,n.snapRadius=1,n.gizmoTranslationSnap=.5,n.gizmoRotationSnap=45,n.gizmoScaleSnap=1,i=Ke;break;case tt.Medium:n.snapEnabled=!0,n.snapRadius=.3,n.gizmoTranslationSnap=.1,n.gizmoRotationSnap=15,n.gizmoScaleSnap=.1,i=Xe;break;case tt.Low:n.snapEnabled=!0,n.snapRadius=.1,n.gizmoTranslationSnap=0,n.gizmoRotationSnap=1,n.gizmoScaleSnap=.1,i=Ye}t.setSnapConfig(n),this.snapBtn&&(this.setButtonIcon(this.snapBtn,i),this.setButtonChecked(this.snapBtn,e!=tt.None))}onEntitySelected(e){if(this.lockBtn&&this.setButtonIcon(this.lockBtn,e.fixed?Ge:ze),this.transformBtn){this.setButtonEnabled(this.transformBtn,!e.fixed);const t=this.viewer.getTransformMode();t==s.Translate&&this.setTranslate(),t==s.Rotate&&this.setRotate(),t==s.Scale&&this.setScale()}if(this.spaceBtn){this.viewer.getTransformSpace()===r.Local?this.setButtonIcon(this.spaceBtn,Ze,He.t("localSpace")):this.setButtonIcon(this.spaceBtn,qe,He.t("worldSpace"))}this.flipBtn&&this.setButtonEnabled(this.flipBtn,!e.fixed),this.deleteBtn&&this.setButtonEnabled(this.deleteBtn,!e.fixed)}onEntityUnselected(){this.transformBtn&&this.setButtonEnabled(this.transformBtn,!1),this.flipBtn&&this.setButtonEnabled(this.flipBtn,!1),this.deleteBtn&&this.setButtonEnabled(this.deleteBtn,!1)}updateTransformButtonStates(e){this.viewer.setTransformMode(e),this.setButtonChecked(this.transformBtn,!0),e===s.Translate?this.setButtonIcon(this.transformBtn,Je):e===s.Rotate?this.setButtonIcon(this.transformBtn,Qe):this.setButtonIcon(this.transformBtn,et)}onKeyDown=e=>{if("KeyR"===e.code){const e=this.viewer.getTransformMode();this.updateTransformButtonStates(e)}};destroy(){super.destroy()}}l("#viewCube{height:150px;position:absolute;right:10px;top:10px;width:150px;z-index:1}");const it=Pe.createInstance();it.init({lng:"en",debug:!1,resources:{en:{translation:{front:"Front",back:"Back",top:"Top",bottom:"Bottom",left:"Left",right:"Right"}},cn:{translation:{front:"前",back:"后",top:"上",bottom:"下",left:"左",right:"右"}}}});const ot=(t,n,i)=>{const o=new e.Color(t),r=new e.Color(n);return o.lerp(r,i).getHex()};var rt,st;!function(e){e.TopFace="TopFace",e.FrontFace="FrontFace",e.RightFace="RightFace",e.BackFace="BackFace",e.LeftFace="LeftFace",e.BottomFace="BottomFace",e.TopFrontEdge="TopFrontEdge",e.TopRightEdge="TopRightEdge",e.TopBackEdge="TopBackEdge",e.TopLeftEdge="TopLeftEdge",e.FrontRightEdge="FrontRightEdge",e.BackRightEdge="BackRightEdge",e.BackLeftEdge="BackLeftEdge",e.FrontLeftEdge="FrontLeftEdge",e.BottomFrontEdge="BottomFrontEdge",e.BottomRightEdge="BottomRightEdge",e.BottomBackEdge="BottomBackEdge",e.BottomLeftEdge="BottomLeftEdge",e.TopFrontRightCorner="TopFrontRightCorner",e.TopBackRightCorner="TopBackRightCorner",e.TopBackLeftCorner="TopBackLeftCorner",e.TopFrontLeftCorner="TopFrontLeftCorner",e.BottomFrontRightCorner="BottomFrontRightCorner",e.BottomBackRightCorner="BottomBackRightCorner",e.BottomBackLeftCorner="BottomBackLeftCorner",e.BottomFrontLeftCorner="BottomFrontLeftCorner"}(rt||(rt={})),function(e){e[e.Rotate0=0]="Rotate0",e[e.Rotate90=Math.PI/2]="Rotate90",e[e.Rotate180=Math.PI]="Rotate180",e[e.Rotate270=1.5*Math.PI]="Rotate270"}(st||(st={}));const at=new e.Vector3(1,0,0),ct=new e.Vector3(0,1,0),lt=new e.Vector3(0,0,1),dt={right:{text:"right",name:rt.RightFace,position:new e.Vector3(50,0,0),rotation:{axis:ct,rad:st.Rotate90}},left:{text:"left",name:rt.LeftFace,position:new e.Vector3(-50,0,0),rotation:{axis:ct,rad:st.Rotate270}},top:{text:"top",name:rt.TopFace,position:new e.Vector3(0,50,0),rotation:{axis:at,rad:st.Rotate270}},bottom:{text:"bottom",name:rt.BottomFace,position:new e.Vector3(0,-50,0),rotation:{axis:at,rad:st.Rotate90}},front:{text:"front",name:rt.FrontFace,position:new e.Vector3(0,0,50),rotation:{axis:ct,rad:st.Rotate0}},back:{text:"back",name:rt.BackFace,position:new e.Vector3(0,0,-50),rotation:{axis:ct,rad:st.Rotate180}}};class ht extends e.Object3D{name="ViewCube";AXIS_COLOR_X=16711680;AXIS_COLOR_Y=65280;AXIS_COLOR_Z=255;FACE_BACKGROUND_COLOR=16777215;FACE_HOVER_BACKGROUND_COLOR=8421584;INNER_CUBE_WIDTH=80;OUTER_CUBE_WIDTH=100;CORNER_WIDTH=(this.OUTER_CUBE_WIDTH-this.INNER_CUBE_WIDTH)/2;AXIS_LENGTH=1.3*this.OUTER_CUBE_WIDTH;EDGE_COLOUR=13684944;EDGE_OPACITY=.2;EDGE_SIZE=new e.Vector2(this.INNER_CUBE_WIDTH,this.CORNER_WIDTH);CORNER_COLOR=13290452;CORNER_OPACITY=1;faces=[];innerViewCubeMesh;showAxes;lineColor;dirty=!1;activateMeshName;constructor(e){super(),this.showAxes=e?.showAxes||!0,this.lineColor=e?.lineColor||9478304,this.init()}init(){this.showAxes&&this.add(this.createAxes()),this.add(this.createViewCubeFaces()),this.add(this.createViewCubeEdges()),this.add(this.createViewCubeCorners())}createAxes(){const t=this.OUTER_CUBE_WIDTH/2+1,n=new e.Object3D,i=new e.Vector3(-t,-t,-t),o=new e.Vector3(1,0,0),r=new e.Vector3(0,1,0),s=new e.Vector3(0,0,1),a=this.AXIS_LENGTH/15,c=this.AXIS_LENGTH/20,l=new e.ArrowHelper(o,i,this.AXIS_LENGTH,this.AXIS_COLOR_X,a,c),d=new e.ArrowHelper(r,i,this.AXIS_LENGTH,this.AXIS_COLOR_Y,a,c),h=new e.ArrowHelper(s,i,this.AXIS_LENGTH,this.AXIS_COLOR_Z,a,c);return n.add(l,d,h),n}createViewCubeFaces(){const t=new e.Object3D,n=[],i=new e.MeshStandardMaterial({color:this.FACE_BACKGROUND_COLOR,opacity:0,transparent:!0});Object.keys(dt).forEach((t=>{const o=dt[t],r=it.t(o.text)||o.text,s=new a({text:r,fontSize:18,color:"#333333",backgroundColor:this.FACE_BACKGROUND_COLOR,padding:.8,fontWeight:"bold"});s.redrew();const c=new e.MeshStandardMaterial({color:this.FACE_BACKGROUND_COLOR,map:s,opacity:1,transparent:!0});n.push(c);const l=this.createViewCubeFace(o.name,i,o.position,o.rotation);l.layers.enableAll(),l.userData={material:c,tick:0,translateTick:0},this.faces.push(l)})),t.add(...this.faces);const o=new e.BoxGeometry(this.INNER_CUBE_WIDTH,this.INNER_CUBE_WIDTH,this.INNER_CUBE_WIDTH),r=new e.Mesh(o,n);this.innerViewCubeMesh=r,t.add(r);const s=new e.EdgesGeometry(new e.BoxGeometry(this.OUTER_CUBE_WIDTH,this.OUTER_CUBE_WIDTH,this.OUTER_CUBE_WIDTH)),c=new e.MeshBasicMaterial({color:this.lineColor}),l=new e.LineSegments(s,c);return t.add(l),t.position.set(0,0,0),t}createViewCubeFace(t,n,i,o){const r=new e.PlaneGeometry(this.INNER_CUBE_WIDTH,this.INNER_CUBE_WIDTH),s=new e.Mesh(r,n);return s.name=t,s.rotateOnAxis(o.axis,o.rad),s.position.copy(i),s}createViewCubeEdges(){const t=new e.Object3D,n=this.OUTER_CUBE_WIDTH/2+1,i=this.createEdge(rt.TopFrontEdge,new e.Vector3(0,n,n),[{axis:lt,rad:st.Rotate180}]),o=this.createEdge(rt.TopRightEdge,new e.Vector3(n,n,0),[{axis:at,rad:st.Rotate180},{axis:ct,rad:st.Rotate90},{axis:lt,rad:st.Rotate0}]),r=this.createEdge(rt.TopBackEdge,new e.Vector3(0,n,-n),[{axis:lt,rad:st.Rotate180},{axis:ct,rad:st.Rotate180}]),s=this.createEdge(rt.TopLeftEdge,new e.Vector3(-n,n,0),[{axis:at,rad:st.Rotate90},{axis:ct,rad:st.Rotate180},{axis:lt,rad:st.Rotate90}]),a=this.createEdge(rt.BottomFrontEdge,new e.Vector3(0,-n,n),[{axis:lt,rad:st.Rotate0}]),c=this.createEdge(rt.BottomRightEdge,new e.Vector3(n,-n,0),[{axis:at,rad:st.Rotate90},{axis:ct,rad:st.Rotate0},{axis:lt,rad:st.Rotate90}]),l=this.createEdge(rt.BottomBackEdge,new e.Vector3(0,-n,-n),[{axis:lt,rad:st.Rotate0},{axis:ct,rad:st.Rotate180}]),d=this.createEdge(rt.BottomLeftEdge,new e.Vector3(-n,-n,0),[{axis:at,rad:st.Rotate90},{axis:ct,rad:st.Rotate270},{axis:lt,rad:st.Rotate90}]),h=this.createEdge(rt.FrontRightEdge,new e.Vector3(n,0,n),[{axis:lt,rad:st.Rotate90}]),u=this.createEdge(rt.BackRightEdge,new e.Vector3(n,0,-n),[{axis:lt,rad:st.Rotate90},{axis:ct,rad:st.Rotate180}]),p=this.createEdge(rt.BackLeftEdge,new e.Vector3(-n,0,-n),[{axis:lt,rad:st.Rotate270},{axis:ct,rad:st.Rotate180}]),g=this.createEdge(rt.FrontLeftEdge,new e.Vector3(-n,0,n),[{axis:lt,rad:st.Rotate270}]);return t.add(i),t.add(o),t.add(r),t.add(s),t.add(a),t.add(c),t.add(l),t.add(d),t.add(h),t.add(u),t.add(p),t.add(g),t}createEdge(t,n,i){const o=new e.Object3D,r=new e.PlaneGeometry(this.EDGE_SIZE.x,this.EDGE_SIZE.y),s=new e.MeshStandardMaterial({color:this.EDGE_COLOUR,opacity:this.EDGE_OPACITY,transparent:!0}),a={tick:0},c=new e.Mesh(r,s);c.name=t,c.userData=a,c.position.setY(this.EDGE_SIZE.y/2),c.layers.enableAll();const l=new e.Mesh(r,s);return l.name=t,l.userData=a,l.position.setZ(-this.EDGE_SIZE.y/2),l.rotateOnAxis(new e.Vector3(1,0,0),Math.PI/2),l.layers.enableAll(),o.add(c),o.add(l),o.position.copy(n),i.forEach((e=>{o.rotateOnAxis(e.axis,e.rad)})),o}createViewCubeCorners(){const t=new e.Object3D,n=this.OUTER_CUBE_WIDTH/2+1,i=this.createCorner(rt.TopFrontLeftCorner,new e.Vector3(-n,n,n),[{axis:lt,rad:st.Rotate270}]),o=this.createCorner(rt.TopFrontRightCorner,new e.Vector3(n,n,n),[{axis:lt,rad:st.Rotate180}]),r=this.createCorner(rt.TopBackRightCorner,new e.Vector3(n,n,-n),[{axis:at,rad:st.Rotate90},{axis:ct,rad:st.Rotate180},{axis:lt,rad:st.Rotate0}]),s=this.createCorner(rt.TopBackLeftCorner,new e.Vector3(-n,n,-n),[{axis:at,rad:st.Rotate90},{axis:ct,rad:st.Rotate180},{axis:lt,rad:st.Rotate90}]),a=this.createCorner(rt.BottomFrontLeftCorner,new e.Vector3(-n,-n,n),[{axis:lt,rad:st.Rotate0}]),c=this.createCorner(rt.BottomFrontRightCorner,new e.Vector3(n,-n,n),[{axis:lt,rad:st.Rotate90}]),l=this.createCorner(rt.BottomBackRightCorner,new e.Vector3(n,-n,-n),[{axis:at,rad:st.Rotate0},{axis:ct,rad:st.Rotate180},{axis:lt,rad:st.Rotate0}]),d=this.createCorner(rt.BottomBackLeftCorner,new e.Vector3(-n,-n,-n),[{axis:at,rad:st.Rotate0},{axis:ct,rad:st.Rotate180},{axis:lt,rad:st.Rotate90}]);return t.add(i),t.add(o),t.add(r),t.add(s),t.add(a),t.add(c),t.add(l),t.add(d),t}createCorner(t,n,i){const o=new e.Object3D,r=new e.PlaneGeometry(this.CORNER_WIDTH,this.CORNER_WIDTH),s=new e.MeshStandardMaterial({color:this.CORNER_COLOR,opacity:this.CORNER_OPACITY,transparent:!0}),a={tick:0},c=new e.Mesh(r,s);c.name=t,c.userData=a,c.position.set(this.CORNER_WIDTH/2,this.CORNER_WIDTH/2,0),c.layers.enableAll();const l=new e.Mesh(r,s);l.name=t,l.userData=a,l.position.set(this.CORNER_WIDTH/2,0,-this.CORNER_WIDTH/2),l.rotateOnAxis(new e.Vector3(1,0,0),Math.PI/2),l.layers.enableAll();const d=new e.Mesh(r,s);return d.name=t,d.userData=a,d.position.set(0,this.CORNER_WIDTH/2,-this.CORNER_WIDTH/2),d.rotateOnAxis(new e.Vector3(0,1,0),-Math.PI/2),d.layers.enableAll(),o.add(c),o.add(l),o.add(d),o.position.copy(n),i.forEach((e=>{o.rotateOnAxis(e.axis,e.rad)})),o}getBBox(){const t=new e.Box3;return t.setFromObject(this),t}getDirectionByElement(t){switch(t){case rt.TopFace:return new e.Vector3(0,1,0);case rt.BottomFace:return new e.Vector3(0,-1,0);case rt.FrontFace:return new e.Vector3(0,0,1);case rt.BackFace:return new e.Vector3(0,0,-1);case rt.LeftFace:return new e.Vector3(-1,0,0);case rt.RightFace:return new e.Vector3(1,0,0);case rt.TopFrontEdge:return new e.Vector3(0,1,1);case rt.TopRightEdge:return new e.Vector3(1,1,0);case rt.TopBackEdge:return new e.Vector3(0,1,-1);case rt.TopLeftEdge:return new e.Vector3(-1,1,0);case rt.BottomFrontEdge:return new e.Vector3(0,-1,1);case rt.BottomRightEdge:return new e.Vector3(1,-1,0);case rt.BottomBackEdge:return new e.Vector3(0,-1,-1);case rt.BottomLeftEdge:return new e.Vector3(-1,-1,0);case rt.FrontLeftEdge:return new e.Vector3(-1,0,1);case rt.FrontRightEdge:return new e.Vector3(1,0,1);case rt.BackRightEdge:return new e.Vector3(1,0,-1);case rt.BackLeftEdge:return new e.Vector3(-1,0,-1);case rt.TopFrontLeftCorner:return new e.Vector3(-1,1,1);case rt.TopFrontRightCorner:return new e.Vector3(1,1,1);case rt.TopBackRightCorner:return new e.Vector3(1,1,-1);case rt.TopBackLeftCorner:return new e.Vector3(-1,1,-1);case rt.BottomFrontLeftCorner:return new e.Vector3(-1,-1,1);case rt.BottomFrontRightCorner:return new e.Vector3(1,-1,1);case rt.BottomBackRightCorner:return new e.Vector3(1,-1,-1);case rt.BottomBackLeftCorner:return new e.Vector3(-1,-1,-1)}}update(){this.traverse((t=>{t instanceof e.Mesh&&this.updateViewCube(t)}))}updateViewCube(e){this.updateMeshTick(e);const t=e.userData.tick;if(e.name.indexOf("Face")>-1){const n=e.userData.material;if(n){const e=ot(this.FACE_BACKGROUND_COLOR,this.FACE_HOVER_BACKGROUND_COLOR,t);t>0&&n.color.set(e)}if(this.innerViewCubeMesh){this.updateMeshTick(e,"translateTick",2);const t=e.position.clone().normalize(),n=Math.max(2*e.userData.translateTick-2,0);t.multiplyScalar(n*this.CORNER_WIDTH/2),n>0&&this.innerViewCubeMesh.position.copy(t)}}else if(e.name.indexOf("Edge")>-1){const n=e.material,i=ot(this.EDGE_COLOUR,this.FACE_HOVER_BACKGROUND_COLOR,t);n.color.set(i),n.opacity=Math.max(t,.1)}else if(e.name.indexOf("Corner")>-1){const n=e.material,i=ot(this.CORNER_COLOR,this.FACE_HOVER_BACKGROUND_COLOR,t);n.color.set(i);const o=1+.3*t;if(e.parent){e.parent.scale.set(o,o,o)}}}updateMeshTick(e,t="tick",n=1){const i=e.userData,o=i[t];void 0!==o&&(e.name===this.activateMeshName&&o<n?i[t]+=.05:e.name!==this.activateMeshName&&o>0&&(i[t]-=.05),i[t]>0&&i[t]<n&&(this.dirty=!0),i[t]=Math.min(Math.max(i[t],0),n))}}class ut extends n{static DEFAULT_ID="ViewCubePlugin";cfg;enabled=!0;container;localScene;localCamera;renderer;directionalLight;width=0;height=0;requestAnimationFrameHandle;renderEnabled=!1;inputManager;viewCube;lastCoords;constructor(e,t){const n=t?.id||ut.DEFAULT_ID;super(e,{id:n}),this.cfg=t||{id:n};let i=this.cfg.containerId?document.getElementById(this.cfg.containerId):void 0;if(!i){const e="viewCube";i=document.createElement("div"),i.id=e;let t=this.viewer.widgetContainer;t||(t=this.viewer.rootElement),t||(t=document.createElement("div"),t.id="widget-container",document.body.appendChild(t)),t.appendChild(i)}this.width=i.clientWidth,this.height=i.clientHeight,this.container=i,this.inputManager=new c(this.container),this.init(),this.animate()}setupConfig(e){this.config=e}get viewerContainer(){return this.container}init(){this.initScene(),this.initRenderer(),this.initCamera(),this.initLights(),this.initLocalization(),this.initViewCube(),this.initEvents()}initScene(){const t=new e.Scene;t.matrixAutoUpdate=!0,this.localScene=t}initRenderer(){this.renderer=new e.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(11119017,0),this.container.appendChild(this.renderer.domElement)}initCamera(){if(!this.localScene)return;const t=new e.OrthographicCamera(-this.width/2,this.width/2,this.height/2,-this.height/2,.1,1e5);t.position.set(300,300,300),t.lookAt(0,0,0),t.zoom=10,t.updateProjectionMatrix(),this.localScene.add(t),this.localCamera=t}initLights(){if(!this.localScene)return;const t=16777215,n=new e.DirectionalLight(t,1.5);n.position.set(-100,80,0),n.name="sun",this.directionalLight=n;const i=new e.AmbientLight(t),o=new e.HemisphereLight(t,14540253,.5);this.localScene.add(i),this.localScene.add(o),this.localScene.add(n),this.localScene.add(n.target)}initLocalization(){const e=this.cfg.language||pt;it.changeLanguage(e)}initViewCube(){if(!this.localScene)return;const e=new ht(this.cfg);this.viewCube=e,this.localScene.add(e),this.zoomToBBox(e.getBBox())}initEvents(){this.inputManager?.addEventListener("pointerdown",this.onPointerDown),this.inputManager?.addEventListener("pointermove",this.onPointerMove),this.inputManager?.addEventListener("pointerleave",this.onPointerleave),this.inputManager?.addEventListener("click",this.onClick);this.viewer.getCameraManager().cameraMovedCallbacks.add((()=>{this.updateCameraAndMeshName()}))}onPointerDown=t=>{if(t.originalEvent?.stopPropagation(),!this.viewCube)return;const n=new e.Vector2(t.x,t.y),i=this.getIntersection(n,[this.viewCube]);if(!i)return;this.lastCoords=n;const o=i.object.name,r=this.viewCube?.getDirectionByElement(o);r&&this.updateViewerCamera(r)};onPointerMove=t=>{t.originalEvent?.stopPropagation();const n=new e.Vector2(t.x,t.y);this.updateActivateMeshName(n),this.lastCoords=n};onPointerleave=e=>{e.originalEvent?.stopPropagation(),this.lastCoords=void 0,this.viewCube?.activateMeshName&&(this.viewCube.activateMeshName=void 0)};onClick=e=>{e.originalEvent?.stopPropagation()};updateViewerCamera(e){e.normalize(),this.viewer.flyToDirection(e)}updateActivateMeshName(e){if(!this.viewCube)return;const t=this.getIntersection(e,[this.viewCube]);if(!t)return;this.viewCube.activateMeshName&&(this.viewCube.activateMeshName=void 0);const n=t.object;this.viewCube.activateMeshName=n.name}updateCameraAndMeshName=()=>{if(!this.viewer?.camera)return;const t=this.viewer.camera,n=new e.Vector3;t.getWorldDirection(n);const i=t.up;this.updateCameraDirection(n,i),this.renderEnabled=!0,this.lastCoords&&this.updateActivateMeshName(this.lastCoords)};updateCameraDirection(e,t){if(!this.localCamera||!e)return;e.normalize();this.localCamera.position.set(200*-e.x+0,200*-e.y+0,200*-e.z+0),this.localCamera.lookAt(0,0,0),this.localCamera.up=t,this.localCamera.updateMatrixWorld()}animate(){this.requestAnimationFrameHandle=requestAnimationFrame(this.animate.bind(this)),this.localScene&&this.localCamera&&this.viewCube&&(this.renderEnabled||this.viewCube.dirty)&&(this.renderer?.render(this.localScene,this.localCamera),this.renderEnabled=!1,this.viewCube.dirty=!1),this.viewCube?.update()}zoomToBBox(t){if(!this.localCamera)return;const n=this.localCamera.right-this.localCamera.left,i=this.localCamera.top-this.localCamera.bottom,o=new e.Vector3;t.getSize(o);const r=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2)+Math.pow(o.z,2)),s=Math.min(n/r,i/r);this.localCamera.position.set(o.x/2,o.y/2,o.z/2),this.localCamera.zoom=s,this.localCamera.updateProjectionMatrix()}getIntersections(t,n){const i=t.x/this.container.clientWidth*2-1,o=-t.y/this.container.clientHeight*2+1,r=new e.Vector2(i,o),s=new e.Raycaster;return s.setFromCamera(r,this.localCamera),s.intersectObjects(n,!0)}getIntersection(e,t){const n=this.getIntersections(e,t);if(n.length>0)return n[0]}destroy(){super.destroy(),this.requestAnimationFrameHandle&&(cancelAnimationFrame(this.requestAnimationFrameHandle),this.requestAnimationFrameHandle=void 0),this.renderer&&(this.renderer.domElement.remove(),this.renderer.clear(),this.renderer.dispose(),this.renderer.forceContextLoss(),this.renderer=void 0),this.container.remove(),this.localScene?.clear(),this.localScene=void 0,this.directionalLight?.dispose(),this.directionalLight=void 0,this.inputManager?.removeEventListener("pointerdown",this.onPointerDown),this.inputManager?.removeEventListener("pointermove",this.onPointerMove),this.inputManager?.removeEventListener("pointerleave",this.onPointerleave),this.inputManager?.removeEventListener("click",this.onClick)}}const pt="en";export{h as AxisGizmoPlugin,v as BottomBarPlugin,pt as DefaultLanguage,b as GroundGridPlugin,Me as PlanToolbarPlugin,Ne as SettingPanel,Ie as SkyboxPlugin,Fe as ToolbarPlugin,u as Tooltip,nt as TransformPlugin,ut as ViewCubePlugin};
